!function(e){var t=!1,a=function(){var e,t=0,a="summary";return null!=(e=location.href.match(/\/userid\/\d+\//i))?(t=e[0].match(/\d+/)[0],a="profile"):null!=(e=location.href.match(/\/groupid\/\d+\//i))&&(t=e[0].match(/\d+/)[0],a="group"),{type:a,target:t}},s=function(e){var t,a,i=0;return 0==e.length?0:"string"!=typeof(a=e.attr("class"))||""==a?0:($.each(a.split(/\s+/),function(e,a){if("object"==typeof(t=a.match(/\d+$/))&&null!=t)return i=parseInt(t[0]),!1}),i)},n=function(e,t){return-1!==e.indexOf(t,e.length-t.length)};"undefined"!=typeof eds3_5_jq&&function(e){e.fn.socialMediaBox=function(){var t,s,o,r,l,c,d,p,m,u,h,v,f,g,y,b,w,k,C,I,D,x,T,j,_,A,q,M,z,W,B,S,O,H,R,P,E,L,$,U,N,J,Y,X,G,F,K,Z,Q,V,ee,te,ae,ie,se,ne,oe={},re={openAt:0,baseClass:"",localized:{},flowplayerSwf:"",flowplayer:{key:"",logo:""},thumbnails:{show:!0,width:100,height:100},itemDetails:{show:!0,rightSide:!0,comments:{notifySocialGroup:!1,requireAuthorInfo:!0,captcha:!0,permissions:{commenting:!0,editing:!1,deleting:!1}},socialButtons:{show:!1,buttons:{facebook:{show:!1,html:'<iframe src="//www.facebook.com/plugins/like.php?href={{encodedUrl}}&amp;send=false&amp;layout=button_count&amp;show_faces=true&amp;action=like&amp;colorscheme=light&amp;font&amp;height=21&amp;width=110" scrolling="no" frameborder="0" style="border:none; overflow:hidden; height:21px; width: 110px;" allowTransparency="true"></iframe>'},gplus:{show:!1,html:'<div class="g-plusone" data-size="medium" data-href="{{url}}"></div><script type="text/javascript">gapi.plusone.go();<\/script>'},twitter:{show:!1,html:'<a href="//twitter.com/share" class="twitter-share-button" data-url="{{url}}" data-text="{{escapedTitle}}">Tweet</a><script type="text/javascript">twttr.widgets.load();<\/script>'},inshare:{show:!1,html:'<script type="IN/Share" data-counter="right" data-url="{{url}}"><\/script><script type="text/javascript">IN.parse();<\/script>'},pinterest:{show:!1,html:'<a href="//pinterest.com/pin/create/button/?url={{encodedUrl}}&media={{encodedMediaUrl}}&description={{encodedTitle}}" class="pin-it-button" count-layout="horizontal"><img border="0" src="//assets.pinterest.com/images/PinExt.png" title="Pin It" /></a>'}}}},events:{onBeforeClose:function(){}},googleReCaptchaSiteKey:""},le=function(e){return"string"==typeof re.localized[e]?re.localized[e]:e},ce=[],de={activeItem:0,resizeInProgress:!1,resizeRace:!1,interfaceHidden:!1,baseWrapper:{height:0,width:0},thumbnails:{rendered:!1,initialized:!1,thumbActivatedChange:!1,allThumbnailsLoaded:!1,thumbnail:{height:0,width:0},wrapper:{height:0,effectiveHeight:0},overview:{width:0}},interfaceActions:{wrapper:{height:0}},itemDetails:{rendered:!1,wrapper:{verticalOffset:0,width:0,effectiveWidth:0},comments:{author:{avatarContainer:null}},maps:{google:null}},itemDisplay:{wrapper:{verticalOffset:0,horizontalOffset:0,height:0,width:0},touch:{newTouch:!1,startX:0,startY:0}},preloadedImages:{},commentsCache:{},reCaptchaId:void 0},pe=function(e,t){t?(de.preloadedImages[e].state="success",de.preloadedImages[e].width=void 0===this.naturalWidth?this.width:this.naturalWidth,de.preloadedImages[e].height=void 0===this.naturalHeight?this.height:this.naturalHeight):de.preloadedImages[e].state="error",clearTimeout(de.preloadedImages[e].timeout)},me=function(e){for(var t=de.preloadedImages[e].callbacks;t.length>0;)t.splice(0,1)[0]();de.preloadedImages[e].callbacks=[]};return terminated=!1,oe.preloadImage=function(t,a){var i=e("<img />"),s=i[0],n=!1,o="number"==typeof a?a:0;if(0==o){if(void 0!==de.preloadedImages[t])return void("loading"==de.preloadedImages[t].state?de.preloadedImages[t].callbacks.push(a):a());de.preloadedImages[t]={state:"loading",callbacks:[a]}}if(de.preloadedImages[t].timeout=setTimeout(function(){!terminated&&o<10&&oe.preloadImage(t,o+1)},4e3*(o+1)),i.bind("load.socialMediaBox error.socialMediaBox",function(e){n||"loading"!=de.preloadedImages[t].state||(pe.apply(s,[t,"load"==e.type]),me(t))}),s.src=t,s.complete&&void 0!==s.naturalWidth)return n=!0,pe.apply(s,[t,0!==s.naturalWidth&&0!==s.naturalHeight]),void me(t)},oe.resize=function(){var e,t,a,i,n,o;de.resizeInProgress?de.resizeRace=!0:(de.resizeInProgress=!0,de.baseWrapper.height=s.height(),de.baseWrapper.width=s.width(),oe.thubnails.resize(),oe.itemDetails.resize(),oe.itemDisplay.resize(),oe.interfaceActions.resize(),ce.length>1&&(e=Math.floor((de.itemDisplay.wrapper.height+de.itemDisplay.wrapper.verticalOffset-ie.height())/2),t=de.itemDisplay.wrapper.width+de.itemDisplay.wrapper.horizontalOffset-se.outerWidth(!0),re.itemDetails.rightSide?(a={top:e,left:0,right:"auto"},i={top:e,left:t,right:"auto"}):(a={top:e,left:"auto",right:t},i={top:e,left:"auto",right:0}),ie.css(a),se.css(i)),o=de.itemDisplay.wrapper.width+de.itemDisplay.wrapper.horizontalOffset-ne.outerWidth(!0),n=re.itemDetails.rightSide?{left:o,right:"auto"}:{left:"auto",right:o},ne.css(n),de.resizeInProgress=!1,de.resizeRace&&(de.resizeRace=!1,oe.resize()))},oe.showItem=function(e,t){e<0?e=ce.length-1:e>=ce.length&&(e=0),!0!==t&&de.activeItem==e||(de.activeItem=e,oe.itemDisplay.showItem(),oe.itemDetails.showItem(),oe.thubnails.showItem())},oe.callbackObject=function(){return{activeItem:de.activeItem,displayItems:ce}},oe.close=function(){"function"==typeof re.events.onBeforeClose&&!1===re.events.onBeforeClose(oe.callbackObject())||(terminated=!0,e(document).off(".socialMediaBox"),e(window).off(".socialMediaBox"),s.fadeOut(200,function(){s.remove(),t.removeClass("socialMediaBoxActive")}))},oe.thubnails={},oe.thubnails.init=function(){var t;!re.thumbnails.show||ce.length<2||(de.thumbnails.rendered=!0,o=e('<div class="thumbnailsMainWrapper"><div class="scrollbar"><div class="track"><div class="thumb"><div class="end"></div></div></div></div><div class="viewport"><div class="overview"></div></div></div>'),r=e("> div.viewport",o),l=e("> div.overview",r),e.each(ce,function(t,a){var i=e('<div><div class="'+a.type+'">'+("video"==a.type||"audio"==a.type?'<div class="playItem"></div>':"")+"</div></div>").appendTo(l);void 0!==a.thumbnail&&void 0!==a.thumbnail.src?oe.preloadImage(a.thumbnail.src,function(){var e,t,s,n,o=re.thumbnails.height,r=re.thumbnails.width,l=r/o;"success"==de.preloadedImages[a.thumbnail.src].state&&(t=de.preloadedImages[a.thumbnail.src].height,s=de.preloadedImages[a.thumbnail.src].width,(t>o||s>r)&&((n=s/t)<l?(s=Math.round(o/t*s),t=o):n>l?(t=Math.round(r/s*t),s=r):(s=r,t=o)),e=t>o?0:Math.floor((o-t)/2),i.css("top",e).fadeIn(300).addClass("visible").find("> div").prepend('<img src="'+a.thumbnail.src+'" alt="" style="height: '+t+"px; width: "+s+'px;" />'),de.thumbnails.initialized&&oe.thubnails.resize())}):i.fadeIn(300).addClass("visible").find("> div").prepend('<div class="noThumb"></div>')}),t=e("> div",l).eq(0),o.appendTo(s),e(">",t).css({width:re.thumbnails.width,height:re.thumbnails.height}),de.thumbnails.thumbnail.height=t.outerHeight(!0),de.thumbnails.thumbnail.width=t.outerWidth(!0),e(">",t).css({width:"",height:""}),l.height(de.thumbnails.thumbnail.height),r.height(de.thumbnails.thumbnail.height),de.thumbnails.wrapper.height=de.thumbnails.wrapper.effectiveHeight=o.outerHeight(!0),o.eds_tinyscrollbar({axis:"x"}),l.on("click","> div",function(){de.thumbnails.thumbActivatedChange=!0,oe.showItem(e(this).index())}),de.thumbnails.initialized=!0)},oe.thubnails.resize=function(){var t,a,i,s=0,n=de.thumbnails.thumbnail.width;!re.thumbnails.show||ce.length<2||(de.thumbnails.thumbActivatedChange?de.thumbnails.thumbActivatedChange=!1:(de.thumbnails.allThumbnailsLoaded||(i=e("> div.visible",l),ce.length==i.length&&(de.thumbnails.allThumbnailsLoaded=!0),de.thumbnails.overview.width=0,i.each(function(){de.thumbnails.overview.width+=e(this).outerWidth(!0)}),l.width(de.thumbnails.overview.width)),t=o.width(),(a=de.thumbnails.overview.width)>t?(l.css({left:0}),(s=n*de.activeItem+Math.floor(n/2))<=Math.floor(t/2)?s=0:a-s<=Math.ceil(t/2)?s="bottom":s-=Math.floor(t/2),o.data("plugin_eds_tinyscrollbar").update(s)):(o.data("plugin_eds_tinyscrollbar").update(),l.css({left:Math.floor((t-a)/2)}))))},oe.thubnails.showItem=function(){!re.thumbnails.show||ce.length<2||(e("> div",l).removeClass("active").eq(de.activeItem).addClass("active"),oe.thubnails.resize())},oe.interfaceActions={},oe.interfaceActions.init=function(){var t;c=e('<div class="interfaceActionsWrapper"></div>'),(de.thumbnails.rendered||de.itemDetails.rendered)&&(d=e('<div class="action toggleInterface"><span>'+le("Hide interface")+"</span></div>").appendTo(c).on("click",function(){var e,a;de.interfaceHidden?(de.interfaceHidden=!1,t.text(le("Hide interface")),d.removeClass("hidden")):(de.interfaceHidden=!0,t.text(le("Show interface")),d.addClass("hidden")),de.thumbnails.rendered&&(e=de.interfaceHidden?-de.thumbnails.wrapper.height:0,o.stop(!0).animate({bottom:e},{duration:200,step:function(e){de.thumbnails.wrapper.effectiveHeight=Math.round(de.thumbnails.wrapper.height+e),oe.resize()}})),de.itemDetails.rendered&&(a=re.itemDetails.rightSide?de.interfaceHidden?{right:-de.itemDetails.wrapper.width}:{right:0}:de.interfaceHidden?{left:-de.itemDetails.wrapper.width}:{left:0},p.stop(!0).animate(a,{duration:200,step:function(e){de.itemDetails.wrapper.effectiveWidth=Math.round(de.itemDetails.wrapper.width+e),oe.resize()}}))}),t=e("> span",d)),s.append(c),de.interfaceActions.wrapper.height=c.outerHeight(!0)},oe.interfaceActions.resize=function(){c.css({bottom:de.thumbnails.wrapper.effectiveHeight})},oe.itemDetails={comments:{}},oe.itemDetails.init=function(){var t='<div class="commentsWrapper">\t\t\t\t\t<h3>'+le("Comments")+'</h3>\t\t\t\t\t<div class="loading"></div>\t\t\t\t\t<p class="message"></p>\t\t\t\t\t<div class="commentsList"></div>\t\t\t\t\t<div class="addCommentContainer">\t\t\t\t\t\t<div class="commentingMessage"></div>\t\t\t\t\t\t<div class="authorInfo name"><div class="text"><span class="label">'+le("Name")+'</span><input type="text" value="" /></div></div>\t\t\t\t\t\t<div class="authorInfo email"><div class="text"><span class="label">'+le("Email")+'</span><input type="text" value="" /></div></div>\t\t\t\t\t\t<div class="textarea"><textarea></textarea></div>\t\t\t\t\t\t<div class="captchaContainer"><div class="captcha"></div></div>\t\t\t\t\t\t<button class="add"><span>'+le("Add comment")+"</span></button>\t\t\t\t\t</div>\t\t\t\t</div>",n='<div class="authorWrapper">\t\t\t\t\t<div class="avatarWrapper">\t\t\t\t\t\t<div class="avatarContainer"></div>\t\t\t\t\t</div>\t\t\t\t\t<div class="actions">\t\t\t\t\t\t<button class="follow"><span>'+le("follow")+'</span></button>\t\t\t\t\t\t<button class="friend"><span>'+le("add as friend")+'</span></button>\t\t\t\t\t\t<button class="friend rejectRequest"><span>'+le("reject friend request")+'</span></button>\t\t\t\t\t</div>\t\t\t\t\t<p class="postedBy">'+le("posted by")+'</p>\t\t\t\t\t<p class="name"></p>\t\t\t\t\t<p class="date"></p>\t\t\t\t</div>',o='<div class="likeWrapper">\t\t\t\t\t<div class="likeContainer">\t\t\t\t\t\t<button><span>'+le("like")+'</span></button>\t\t\t\t\t\t<p></p>\t\t\t\t\t</div>\t\t\t\t\t<ul class="alsoLiked"></ul>\t\t\t\t</div>',r='<div class="buttonsWrapper">\t\t\t\t\t<a href="#" class="email"><span>'+le("Send link")+'</span></a>\t\t\t\t\t<a href="#" target="_blank" class="download"><span>'+le("Download")+"</span></a>\t\t\t\t</div>",l='<div class="metaWrapper"><h3><span>'+le("Details")+'</span></h3><div class="content"></div></div>';re.itemDetails.show&&(p=e('<div class="itemDetailsWrapper '+(re.itemDetails.rightSide?"right":"left")+'"><div class="viewport"><div class="overview"><h2></h2><div class="description"></div>'+n+o+'<div class="socialButtonsWrapper"></div><div class="ratingWrapper">\t\t\t\t\t<div class="starContainer">\t\t\t\t\t\t<div></div>\t\t\t\t\t</div>\t\t\t\t\t<p class="score"></p>\t\t\t\t\t<p class="message"></p>\t\t\t\t</div><ul class="tagContainer"></ul>'+r+t+l+'</div></div><div class="scrollbar"><div class="track"><div class="thumb"><div class="end"></div></div></div></div></div>'),m=e("> .viewport",p),u=e("> .overview",m),h=e("> h2",u),v=e("> div.description",u),f=e("> .authorWrapper",u),g=e("> .avatarWrapper",f),y=e("> .avatarContainer",g),b=e("> .name",f),w=e("> .date",f),k=e("> .actions",f),C=e("> .follow",k),I=e("> .friend",k).eq(0),D=e("> .friend",k).eq(1),x=e("> .likeWrapper",u),T=e("> .likeContainer",x),j=e("> button",T),_=e("> p",T),A=e("> .alsoLiked",x),q=e("> .socialButtonsWrapper",u),M=e("> .ratingWrapper",u),z=e("p.score",M),W=e("p.message",M),B=e("> div.starContainer",M),S=e("> div",B),O=e("> .tagContainer",u),H=e("> .buttonsWrapper",u),R=e("> .download",H),P=e("> .email",H),E=e("> div.commentsWrapper",u),L=e("> p.message",E),$=e("> div.commentsList",E),U=e("> div.loading",E),N=e("> div.addCommentContainer",E),J=e("> button.add",N),Y=e("> div > textarea",N),X=e("> .commentingMessage",N),G=e("> .authorInfo",N),F=e("> .text",G),K=e("> div.captchaContainer",N),Z=e("> .metaWrapper",u),Q=e("> h3",Z),V=e("> .content",Z),s.append(p),de.itemDetails.wrapper.verticalOffset=p.outerHeight(!0)-p.height(),de.itemDetails.wrapper.width=de.itemDetails.wrapper.effectiveWidth=p.outerWidth(!0),q.css("display",re.itemDetails.socialButtons.show?"block":"none"),F.click(function(){var t=e(this);return e("> input",t).focus(),!1}),e("> input",F).focus(function(){var t=e(this).siblings("span");""==this.value&&t.stop(!0).fadeTo(200,0,function(){t.css("display","none")})}).blur(function(){""==this.value&&e(this).siblings("span").stop(!0).css("display","").fadeTo(200,1)}),J.on("click",function(){var t,i,s,n=Y.val(),o=de.activeItem,r=ce[o],l="",c={},d={},m=[],u="",h=a(),v={action:"add_comment",journalType:h.type,journalTarget:h.target};if(!N.hasClass("sending")){if(re.itemDetails.comments.notifySocialGroup&&(v.notifySocialGroup=!0,v.journalModuleId=0),re.itemDetails.comments.requireAuthorInfo&&(t=e("> div > input",G.filter(".name")).val(),i=e("> div > input",G.filter(".email")).val(),""===t&&m.push(le("a name")),""!==i&&/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(i)||m.push(le("a valid email address"))),""==n&&m.push(le("a comment")),re.itemDetails.comments.requireAuthorInfo&&re.itemDetails.comments.captcha&&""===(s=grecaptcha.getResponse(de.reCaptchaId))&&m.push(le("the captcha")),0!==m.length)return u="<p>"+le("Please specify")+" ",e.each(m,function(e,t){e>0&&(e+1==m.length?u+=" "+le("and")+" ":u+=", "),u+=t}),u+="</p>",X.css("display","block").removeClass("positive").html(u).addClass("negative"),void p.data("plugin_eds_tinyscrollbar").update("relative");Y[0].disabled=!0,N.addClass("sending"),X.css("display","block").removeClass("negative positive").html("<p>"+le("Sending...")+"</p>"),v.comment=n,re.itemDetails.comments.requireAuthorInfo&&(v.name=t,v.email=i,re.itemDetails.comments.captcha&&(v.captcha=s)),e.ajax({data:v,dataType:"json",type:"POST",url:r.comments.backend,timeout:15e3,cache:!1,error:function(){l=le("The comment can't currently be saved. Please try again later.")},success:function(e){if(null!=e.status)switch(e.status){case"success":c.author=e.author.id,c.content=e.comment,c.raw=n,c.id=e.id,c.dateHtml=e.dateHtml,de.commentsCache[r.comments.backend].comments.push(c),d=null==de.commentsCache[r.comments.backend].authors[c.author]?de.commentsCache[r.comments.backend].authors[c.author]={avatar:e.author.avatar,name:e.author.name,url:e.author.url}:de.commentsCache[r.comments.backend].authors[c.author];break;case"error":l=e.message;break;case"captcha_error":l=e.message}else l=le("The comment can't currently be saved. Please try again later.")},complete:function(){o==de.activeItem&&(""==l?($.css("display","block"),L.css("display","none"),oe.itemDetails.comments.renderCommentBox(c,d),oe.itemDetails.comments.setAvatarContainerDimensions(),oe.itemDetails.comments.loadAvatars(c.author,d),Y.val(""),X.css("display","none")):X.css("display","block").addClass("negative").html("<p>"+l+"</p>"),N.removeClass("sending"),Y[0].disabled=!1,re.itemDetails.comments.requireAuthorInfo&&re.itemDetails.comments.captcha&&grecaptcha.reset(de.reCaptchaId),p.data("plugin_eds_tinyscrollbar").update("relative"))}}),p.data("plugin_eds_tinyscrollbar").update("relative")}}),$.on("click",".actionsBoxTrigger li.edit",function(){var t,a=e(this).parents().eq(2),i=e("> .content",a),s=!1,n=ce[de.activeItem];return s="object"==typeof n.comments&&"object"==typeof n.comments.permissions&&"boolean"==typeof n.comments.permissions.editing?n.comments.permissions.editing:re.itemDetails.comments.permissions.editing,!(a.data("editing")||!s||(clearTimeout(a.data("saveMsgTimeout")),a.data("editing",!0),e("> .editor",a).remove(),i.css("display","none"),t=e('<div class="editor"><div class="textarea"><textarea style="height: '+i.height()+'px;"></textarea></div><div class="actions"><p></p><span class="save">'+le("Save")+'</span><span class="cancel">'+le("Cancel")+"</span></div></div>").appendTo(a),e(".textarea > textarea",t).val(a.data("comment").raw).focus(),p.data("plugin_eds_tinyscrollbar").update("relative"),1))}).on("click",".editor > .actions > span",function(){var t,a,i,s,n=e(this),o=n.parent(),r=n.parents().eq(2),l=r.data("comment"),c="",d=de.activeItem,m=ce[d],u={};if(r.data("saving"))return!1;if(n.hasClass("save")){if(i=e("> .editor > .textarea > textarea",r),""==(s=i.val()))return a=e("> p",o).text(le("Please specify a comment")).addClass("negative").removeClass("positive").css("display","block"),void p.data("plugin_eds_tinyscrollbar").update("relative");r.data("saving",!0),i[0].disabled=!0,a=e("> p",o).text(le("Saving...")).removeClass("negative positive").css("display","block"),t=e("> span",o).css("display","none"),e.ajax({data:{action:"edit_comment",id:l.id,comment:s},dataType:"json",type:"POST",url:m.comments.backend,timeout:15e3,cache:!1,error:function(){c=le("Your changes can't currently be saved.")},success:function(t){if(null!=t.status)switch(t.status){case"success":u=e.extend(!0,{},l,{raw:s,content:t.comment,dateHtml:t.dateHtml}),e.each(de.commentsCache[m.comments.backend].comments,function(e,t){if(t.id==l.id)return de.commentsCache[m.comments.backend].comments[e]=u,!1});break;case"error":c=t.message}else c=le("Your changes can't currently be saved.")},complete:function(){d==de.activeItem&&(c?(i[0].disabled=!1,t.css("display",""),a.addClass("negative").text(c)):(a.addClass("positive").text(le("Your changes were saved")),e("> .editor > .textarea",r).remove(),e("> .content",r).css("display","block").html(u.content),e("> .meta > .commentDate",r).html(u.dateHtml),r.data({editing:!1,comment:u,saveMsgTimeout:setTimeout(function(){terminated||d!=de.activeItem||e("> .editor",r).remove(),p.data("plugin_eds_tinyscrollbar").update("relative")},3e3)})),r.data("saving",!1),p.data("plugin_eds_tinyscrollbar").update("relative"))}})}else r.data("editing",!1),e("> .editor",r).remove(),e("> .content",r).css("display","block");return p.data("plugin_eds_tinyscrollbar").update("relative"),!1}).on("click",".actionsBoxTrigger li.delete",function(){var t=e(this).parents().eq(2);return t.addClass("hideActions"),e("> .deleteConfirmation",t).css("display","block"),p.data("plugin_eds_tinyscrollbar").update("relative"),!1}).on("click",".deleteConfirmation span",function(){var t=e(this),a=t.parents().eq(2),i=(a.index(),a.data("comment")),s=e("> .deleteConfirmation",a),n=e("> .message",s),o="",r=de.activeItem,l=ce[r];return t.hasClass("delete")?(e("> p",s).css("display","none"),n.text(le("Deleting...")).css("display","block"),e.ajax({data:{action:"delete_comment",id:i.id},dataType:"json",type:"GET",url:l.comments.backend,timeout:15e3,cache:!1,error:function(){o=le("The comment can't currently be deleted.")},success:function(t){if(null!=t.status)switch(t.status){case"success":e.each(de.commentsCache[l.comments.backend].comments,function(e,t){if(t.id==i.id)return de.commentsCache[l.comments.backend].comments.splice(e,1),!1});break;case"error":o=t.message}else o=le("Your changes can't currently be saved.")},complete:function(){r==de.activeItem&&(o?(n.addClass("negative").text(o),a.removeClass("hideActions")):(a.remove(),0==e(">",$).length&&($.css("display","none"),L.addClass("noComments").text(le("No comments yet")).css("display","block"))),p.data("plugin_eds_tinyscrollbar").update("relative"))}})):(a.removeClass("hideActions"),s.css("display","none"),n.css("display","none")),p.data("plugin_eds_tinyscrollbar").update("relative"),!1}),B.on("mousemove",function(e){var t,a,i=ce[de.activeItem],s=B.offset();i.rating.rated||null==i.rating.backend||(t=B.width()/5,a=Math.ceil((e.clientX-s.left)/t),B.data("stars",a),S.css("width",t*a+"px"))}).on("mouseleave",function(){var e=ce[de.activeItem],t=e.rating.score;null!=e.rating.backend&&(!1!==e.rating.rated&&(t=e.rating.rated),S.css("width",t/5*100+"%"))}).on("click",function(){var t=de.activeItem,a=ce[t],i=!1,s=le("Rating is currently not possible.");!1===a.rating.rated&&null!=a.rating.backend&&(ce[t].rating.rated=B.data("stars"),B.addClass("rated"),S.css("width",a.rating.rated/5*100+"%"),e.ajax({data:{action:"rate",rating:a.rating.rated},dataType:"json",type:"POST",url:a.rating.backend,timeout:15e3,cache:!1,error:function(){i=s},success:function(e){if(null!=e.status)switch(e.status){case"success":ce[t].rating.score=e.score;break;case"error":i=e.message}else i=s},complete:function(){i&&(ce[t].rating.rated=!1),t==de.activeItem&&(i?(B.removeClass("rated"),S.css("width",ce[t].rating.score/5*100+"%"),W.addClass("negative").css("display","block").text(i)):z.removeClass("noRatings").text(ce[t].rating.score),p.data("plugin_eds_tinyscrollbar").update("relative"))}}))}),C.on("click",function(){var t=de.activeItem,a=ce[t],s=!1,n=!a.author.following;!0!==C.data("disabled")&&(C.data("disabled",!0).addClass("requesting"),e.ajax({data:{action:"follow",follow:n},dataType:"json",type:"POST",url:a.author.backend,timeout:1e4,cache:!1,error:function(){s=!0},success:function(e){if(null!=e.status)switch(e.status){case"success":for(i in ce)"object"==typeof ce[i].author&&void 0!==ce[i].author.id&&ce[i].author.id==a.author.id&&(ce[i].author.following=n);break;case"error":s=!0}else s=!0},complete:function(){t==de.activeItem&&(C.data("disabled",!1).removeClass("requesting"),s||(n?C.addClass("unfollow").find("> span").text(le("unfollow")):C.removeClass("unfollow").find("> span").text(le("follow"))),p.data("plugin_eds_tinyscrollbar").update("relative"))}}),p.data("plugin_eds_tinyscrollbar").update("relative"))}),I.on("click",function(){var t,a=de.activeItem,s=ce[a],n=!1;!0!==I.data("disabled")&&(I.data("disabled",!0).addClass("requesting"),"requested_by_author"==s.author.friends?(D.addClass("requesting"),t=!0):t=!0!==s.author.friends&&"requested_by_user"!=s.author.friends,e.ajax({data:{action:"friend",friends:t},dataType:"json",type:"POST",url:s.author.backend,timeout:1e4,cache:!1,error:function(){n=!0},success:function(e){if(null!=e.status)switch(e.status){case"success":for(i in t=e.friends,ce)"object"==typeof ce[i].author&&void 0!==ce[i].author.id&&ce[i].author.id==s.author.id&&(ce[i].author.friends=t);break;case"error":n=!0}else n=!0},complete:function(){a==de.activeItem&&(I.data("disabled",!1).removeClass("requesting"),D.removeClass("requesting"),n||(D.css("display","none"),I.removeClass("unfriend cancelRequest acceptRequest"),!0===t?I.addClass("unfriend").find("> span").text(le("unfriend")):"requested_by_user"==t?I.addClass("cancelRequest").find("> span").text(le("cancel friend request")):I.find("> span").text(le("add as friend"))),p.data("plugin_eds_tinyscrollbar").update("relative"))}}),p.data("plugin_eds_tinyscrollbar").update("relative"))}),D.on("click",function(){var t=de.activeItem,a=ce[t],s=!1;"requested_by_author"==a.author.friends&&!0!==I.data("disabled")&&(I.data("disabled",!0).addClass("requesting"),D.addClass("requesting"),e.ajax({data:{action:"friend",friends:!1},dataType:"json",type:"POST",url:a.author.backend,timeout:1e4,cache:!1,error:function(){s=!0},success:function(e){if(null!=e.status)switch(e.status){case"success":for(i in ce)"object"==typeof ce[i].author&&void 0!==ce[i].author.id&&ce[i].author.id==a.author.id&&(ce[i].author.friends=!1);break;case"error":s=!0}else s=!0},complete:function(){t==de.activeItem&&(I.data("disabled",!1).removeClass("requesting unfriend cancelRequest acceptRequest"),D.removeClass("requesting"),s||(D.css("display","none"),I.find("> span").text(le("add as friend"))),p.data("plugin_eds_tinyscrollbar").update("relative"))}}),p.data("plugin_eds_tinyscrollbar").update("relative"))}),j.on("click",function(){var t=de.activeItem,a=ce[t],i=!1,s=!a.likes.liked;!0!==j.data("disabled")&&(j.data("disabled",!0).addClass("requesting"),e.ajax({data:{action:"like",liked:s},dataType:"json",type:"POST",url:a.likes.backend,timeout:1e4,cache:!1,error:function(){i=!0},success:function(e){if(null!=e.status)switch(e.status){case"success":ce[t].likes.liked=s,ce[t].likes.message=e.message;break;case"error":i=!0}else i=!0},complete:function(a){var n;if(t==de.activeItem){if(j.data("disabled",!1).removeClass("requesting"),i){try{n=e.parseJSON(a.responseText).message}catch(e){n=le("An error occurred while "+(s?"saving your like":"removing your like"))}_.addClass("negative").text(n)}else _.removeClass("negative").text(ce[t].likes.message),s?j.addClass("unlike").find("> span").text(le("unlike")):j.removeClass("unlike").find("> span").text(le("like"));p.data("plugin_eds_tinyscrollbar").update("relative")}}}),p.data("plugin_eds_tinyscrollbar").update("relative"))}),Q.on("click",function(){var e=ce[de.activeItem],t="block";V.is(":visible")&&(t="none"),V.css("display",t),"block"==t?(Q.addClass("close"),"object"==typeof e.meta.map&&"google"==e.meta.map.type&&(google.maps.event.trigger(de.itemDetails.maps.google,"resize"),de.itemDetails.maps.google.setCenter(new google.maps.LatLng(e.meta.map.settings.lat,e.meta.map.settings.lng)))):Q.removeClass("close"),p.data("plugin_eds_tinyscrollbar").update("relative")}),de.itemDetails.rendered=!0,p.eds_tinyscrollbar({axis:"y"}))},oe.itemDetails.placeAvatar=function(e){var t,a,i,s,n=0,o=0,r=null,l=null,c=de.preloadedImages[e.src];if(null==e.fadeIn&&(e.fadeIn=!1),void 0===c||"loading"==c.state)return e.fadeIn=!0,void oe.preloadImage(e.src,function(){oe.itemDetails.placeAvatar(e)});"object"==typeof e.containerDimensions?(t=e.containerDimensions.height,a=e.containerDimensions.width):(t=e.$container.height(),a=e.$container.width()),"success"==c.state&&(r=c.height+4,l=c.width+4,(r>t||l>a)&&((s=l/r)<(i=a/t)?(l=Math.round(t/r*l),r=t):s>i?(r=Math.round(a/l*r),l=a):(l=a,r=t)),o=r==t?0:Math.floor((t-r)/2),n=l==a?0:Math.floor((a-l)/2),r-=4,l-=4),e.$container.append('<img src="'+e.src+'" alt="" style="'+(e.fadeIn?"display: none; ":"")+(null!=l?"width: "+l+"px; ":"")+(null!=r?"height: "+r+"px; ":"")+"top: "+o+"px; left: "+n+'px;" />'),e.fadeIn&&e.$container.find(">").fadeIn(200)},oe.itemDetails.comments.renderCommentBox=function(t,a){var i,s,n,o=ce[de.activeItem],r=!1,l=!1;r="object"==typeof o.comments&&"object"==typeof o.comments.permissions&&"boolean"==typeof o.comments.permissions.editing?o.comments.permissions.editing:re.itemDetails.comments.permissions.editing,l="object"==typeof o.comments&&"object"==typeof o.comments.permissions&&"boolean"==typeof o.comments.permissions.deleting?o.comments.permissions.deleting:re.itemDetails.comments.permissions.deleting,i=(r&&!0!==o.journalEntry?'<li class="edit"><span>'+le("Edit")+"</span></li>":"")+(l?'<li class="delete"><span>'+le("Delete")+"</span></li>":""),n="string"==typeof a.url&&""!=a.url?'<a href="'+a.url+'">'+a.name+"</a>":a.name,s=e('<div class="author-'+t.author+("string"==typeof a.avatar&&""!=a.avatar?" hasAvatar":"")+'"><div class="deleteConfirmation"><p class="message"></p><p>'+le("Do you really want to delete this comment?")+'</p><p><span class="delete">'+le("Yes")+'</span><span class="cancel">'+le("No")+'</span></p></div><div class="meta"><div class="authorAvatarWrapper"><div class="authorAvatarContainer"></div></div><h4>'+n+'</h4><p class="commentDate">'+t.dateHtml+'</p></div><div class="content">'+t.content+"</div>"+(""==i?"":'<div class="actionsBoxTrigger"><ul>'+i+"</ul></div>")+"</div>").data("comment",t),$.append(s)},oe.itemDetails.comments.loadAvatars=function(t,a){var i,s=e("> .author-"+t+" > .meta > .authorAvatarWrapper",$).filter(":hidden");0!=s.lenght&&void 0!==a.avatar&&""!=a.avatar&&(s.css("display","block"),"string"==typeof a.url&&""!=a.url?(e(">",s).append(e('<a href="#" />').attr("href",a.url)),i=e("> >",s)):i=e(">",s),oe.itemDetails.placeAvatar({src:a.avatar,$container:i,containerDimensions:de.itemDetails.comments.author.avatarContainer}))},oe.itemDetails.comments.setAvatarContainerDimensions=function(){null==de.itemDetails.comments.author.avatarContainer&&($authorAvatarWrapper=e(".authorAvatarWrapper",$).eq(0).css("display","block"),de.itemDetails.comments.author.avatarContainer={width:$authorAvatarWrapper.width(),height:$authorAvatarWrapper.height()},$authorAvatarWrapper.css("display","none"))},oe.itemDetails.comments.display=function(t){var a=ce[de.activeItem];U.css("display","none"),t.comments.length>0?(L.css("display","none"),$.empty(),e.each(t.comments,function(e,a){oe.itemDetails.comments.renderCommentBox(a,t.authors[a.author])}),$.css("display","block"),oe.itemDetails.comments.setAvatarContainerDimensions(),e.each(t.authors,oe.itemDetails.comments.loadAvatars)):($.empty().css("display","none"),L.addClass("noComments").text(le("No comments yet")).css("display","block")),("object"==typeof a.comments&&"object"==typeof a.comments.permissions&&"boolean"==typeof a.comments.permissions.commenting?a.comments.permissions.commenting:re.itemDetails.comments.permissions.commenting)?(re.itemDetails.comments.requireAuthorInfo?(G.css("display","block"),re.itemDetails.comments.captcha&&(K.css("display","block"),de.reCaptchaId?grecaptcha.reset(de.reCaptchaId):de.reCaptchaId=grecaptcha.render(e("> .captcha",K)[0],{sitekey:re.googleReCaptchaSiteKey,size:"compact"}))):(G.css("display","none"),K.css("display","none")),N.removeClass("sending").css("display","block"),Y[0].disabled=!1,X.css("display","none"),Y.val("")):N.css("display","none")},oe.itemDetails.showItem=function(){var t,a,i,s=de.activeItem,n=ce[s],o="",r=!1,l="",c="",d="",m="",u="";if(re.itemDetails.show){if(null==n.title||""==n.title?(h.css("display","none"),v.removeClass("withTitle")):(h.text(n.title).css("display","block"),v.addClass("withTitle")),null==n.description||""==n.description?v.css("display","none"):v.html(n.description).css("display","block"),re.itemDetails.socialButtons.show&&"object"==typeof n.social&&""!=n.social.url?(c="string"!=typeof n.social.media?"":n.social.media,e.each(re.itemDetails.socialButtons.buttons,function(e,t){if(t.show){if("pinterest"==e&&""==c)return;if("twitter"==e&&("undefined"==typeof twttr||void 0===twttr.widgets))return;if("inshare"==e&&("undefined"==typeof IN||"function"!=typeof IN.parse))return;l+="<div>"+t.html+"</div>"}}),""==l?q.css("display","none").empty():("string"==typeof n.title&&""!=n.title?(u=n.title.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),l=l.replace(/{{encodedTitle}}/g,encodeURIComponent(n.title))):l=l.replace(/{{encodedTitle}}/g,""),l=l.replace(/{{url}}/g,n.social.url).replace(/{{escapedTitle}}/g,u).replace(/{{encodedUrl}}/g,encodeURIComponent(n.social.url)),c&&(l=l.replace(/{{encodedMediaUrl}}/g,encodeURIComponent(c))),q.css("display","block").html(l),c&&re.itemDetails.socialButtons.buttons.pinterest.show&&e.ajax({url:"//assets.pinterest.com/js/pinit.js",dataType:"script",cache:!1}))):q.css("display","none").empty(),"object"==typeof n.rating?(B.removeClass("rated"),n.rating.score>0?(z.removeClass("noRatings").text(n.rating.score),!1===n.rating.rated?t=n.rating.score:(t=n.rating.rated,B.addClass("rated")),S.css("width",t/5*100+"%")):(z.addClass("noRatings").text(le("No ratings")),S.css("width","")),W.css("display","none").removeClass("negative"),M.css("display","block"),null==n.rating.backend?M.addClass("cantRate"):M.removeClass("cantRate")):M.css("display","none"),"object"!=typeof n.comments||null==n.comments.backend||""==n.comments.backend?E.css("display","none"):(E.css("display","block"),$.css("display","none"),L.removeClass("noComments negative").css("display","none"),N.css("display","none"),null==de.commentsCache[n.comments.backend]?(U.css("display","block"),e.ajax({data:{action:"list_comments"},dataType:"json",type:"GET",url:n.comments.backend,timeout:15e3,cache:!1,error:function(){s==de.activeItem&&L.addClass("negative").removeClass("noComments").text(le("Comments are currently unavalible")).css("display","block")},success:function(e){de.commentsCache[n.comments.backend]=e,s==de.activeItem&&(oe.itemDetails.comments.display(e),p.data("plugin_eds_tinyscrollbar").update())}})):oe.itemDetails.comments.display(de.commentsCache[n.comments.backend])),"object"==typeof n.author?(f.css("display","block"),m="string"==typeof n.author.url&&""!=n.author.url?n.author.url:"","string"==typeof n.author.avatar&&""!=n.author.avatar?(g.css("display","block"),y.empty(),i=""==m?y:e('<a href="#" />').appendTo(y).attr({href:m}),oe.itemDetails.placeAvatar({src:n.author.avatar,$container:i})):g.css("display","none"),b.empty(),""==m?b.text(n.author.name):b.append(e("<a />").attr({href:m}).text(n.author.name)),w.html(n.author.dateHtml),null!=n.author.isUser&&n.author.isUser?k.css("display","none"):(k.css("display","block"),null==n.author.following?C.css("display","none"):(C.data("disabled",!1).css("display","block"),n.author.following?C.addClass("unfollow").find("> span").text(le("unfollow")):C.removeClass("unfollow").find("> span").text(le("follow"))),D.css("display","none").removeClass("requesting"),null==n.author.friends?I.css("display","none"):(I.removeClass("requesting unfriend cancelRequest acceptRequest").data("disabled",!1).css("display","block"),!0===n.author.friends?I.addClass("unfriend").find("> span").text(le("unfriend")):"requested_by_user"==n.author.friends?I.addClass("cancelRequest").find("> span").text(le("cancel friend request")):"requested_by_author"==n.author.friends?(I.addClass("acceptRequest").find("> span").text(le("accept friend request")),D.css("display","block")):I.find("> span").text(le("add as friend"))))):f.css("display","none"),"object"==typeof n.likes?(x.css("display","block"),"string"==typeof n.likes.backend&&""!=n.likes.backend?(j.css("display","").data("disabled",!1),n.likes.liked?j.addClass("unlike").find("> span").text(le("unlike")):j.removeClass("unlike").find("> span").text(le("like"))):j.css("display","none"),"string"!=typeof n.likes.message||""==n.likes.message?_.css("display","none"):_.removeClass("negative").css("display","block").text(n.likes.message),"object"!=typeof n.likes.alsoLiked||0==n.likes.alsoLiked.length?A.css("display","none"):(A.css("display","block").empty(),e.each(n.likes.alsoLiked,function(t,a){var i=e("<li><div></div></li>").appendTo(A).find("> div");"string"==typeof a.url&&""!=a.url&&(i=i.html('<a href="'+a.url+'"></a>').find("> a")),i.attr("title",a.name),oe.itemDetails.placeAvatar({src:a.avatar,$container:i})}))):x.css("display","none"),"object"==typeof n.tags?(e.each(n.tags,function(e,t){o+='<li data-id="'+e+'"><span>'+t+"</span></li>"}),""==o?O.css("display","none"):O.css("display","block").html(o)):O.css("display","none"),"string"!=typeof n.download||""==n.download?R.css("display","none"):(r=!0,R.attr("href",n.download).css("display","")),"object"==typeof n.email?(r=!0,P.attr("href","mailto:?to=&subject="+encodeURIComponent(n.email.subject)+"&body="+encodeURIComponent(n.email.body)).css("display","")):P.css("display","none"),H.css("display",r?"block":"none"),"object"==typeof n.meta){if(Z.css("display","block"),"object"==typeof n.meta.exif&&(d='<div class="exif"><h4><span>'+le("Exif")+"</span></h4><table><tbody>",e.each(n.meta.exif,function(e,t){d+='<tr><td class="cell1">'+e+'</td><td class="cell2">'+t+"</td></tr>"}),V.html(d+"</tbody></table></div>")),"object"==typeof n.meta.map)switch(V.append('<div class="map">'+(null==n.meta.map.title?"":"<h4><span>"+n.meta.map.title+"</span></h4>")+"<div></div></div>"),de.itemDetails.maps.google=null,n.meta.map.type){case"google":"object"==typeof google&&"object"==typeof google.maps&&(a=new google.maps.LatLng(n.meta.map.settings.lat,n.meta.map.settings.lng),de.itemDetails.maps.google=new google.maps.Map(e("> div.map > div",V)[0],{center:a,zoom:n.meta.map.settings.zoom,mapTypeId:google.maps.MapTypeId[n.meta.map.settings.type],scrollwheel:!1}),new google.maps.Marker({position:a,map:de.itemDetails.maps.google}))}V.css({display:"none"})}else Z.css("display","none");p.data("plugin_eds_tinyscrollbar").update()}},oe.itemDetails.resize=function(){re.itemDetails.show&&(p.height(de.baseWrapper.height-de.itemDetails.wrapper.verticalOffset-de.thumbnails.wrapper.effectiveHeight-de.interfaceActions.wrapper.height),p.data("plugin_eds_tinyscrollbar").update("relative"))},oe.itemDisplay={},oe.itemDisplay.init=function(){ee=e('<div class="itemDisplayWrapper '+(re.itemDetails.rightSide?"left":"right")+'"></div>'),s.append(ee),de.itemDisplay.wrapper.verticalOffset=ee.outerHeight(!0)-ee.height(),de.itemDisplay.wrapper.horizontalOffset=ee.outerWidth(!0)-ee.width(),te=e('<div class="itemDisplayContainer"></div>').appendTo(ee),ae=e('<div class="loadIndicator"></div>').appendTo(ee)},oe.itemDisplay.resize=function(){var t,a,i,s,n,o,r,l,c,d=ce[de.activeItem];switch(de.itemDisplay.wrapper.height=de.baseWrapper.height-de.itemDisplay.wrapper.verticalOffset-de.thumbnails.wrapper.effectiveHeight-de.interfaceActions.wrapper.height,de.itemDisplay.wrapper.width=de.baseWrapper.width-de.itemDisplay.wrapper.horizontalOffset-de.itemDetails.wrapper.effectiveWidth,ee.height(de.itemDisplay.wrapper.height).width(de.itemDisplay.wrapper.width),n=e("> .item.active",te),d.type){case"image":if(0==n.length)return;o={width:de.preloadedImages[d.src].width,height:de.preloadedImages[d.src].height};break;case"video":o={width:d.video.width,height:d.video.height};break;case"audio":o={width:450,height:n.height()}}l={width:te.width(),height:te.height()},"video"==d.type||"image"==d.type&&(o.width>l.width||o.height>l.height)||"audio"==d.type&&o.width>l.width?(c=l.width/l.height,r=o.width/o.height,t=l.width,a="audio"==d.type?o.height:l.height,r<c?t=Math.round(l.height/o.height*o.width):r>c&&"audio"!=d.type&&(a=Math.round(l.width/o.width*o.height))):(t=o.width,a=o.height),s=Math.floor((l.width-t)/2),i=Math.floor((l.height-a)/2),n.css({width:t,height:a,marginTop:i,marginLeft:s})},oe.itemDisplay.showItem=function(){var t,a,i,s=de.activeItem,o=ce[s],r=function(){t=te.find(">").fadeOut(200,function(){t.remove()}).removeClass("active"),e('<img class="item active" src="'+o.src+'" alt="" style="display: none;" />').appendTo(te).fadeIn(200),oe.itemDisplay.resize(),ae.stop(!0).fadeOut(500)},l="";switch(o.type){case"image":void 0!==de.preloadedImages[o.src]&&"success"==de.preloadedImages[o.src].state?r():(ae.css({display:"none",left:0}).stop(!0).fadeIn(500,function(){te.find(">").remove()}),oe.preloadImage(o.src,function(){s==de.activeItem&&r()}));break;case"video":switch(t=te.find(">").removeClass("active").fadeOut(200,function(){t.remove()}),o.video.provider){case"youtube":a='<iframe class="item active" style="display: none;" src="//www.youtube.com/embed/'+o.video.id+'?wmode=opaque" frameborder="0" allowfullscreen></iframe>';break;case"vimeo":a='<iframe class="item active" style="display: none;" src="//player.vimeo.com/video/'+o.video.id+'" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>';break;case"wistia":a='<iframe class="wistia_embed item active" name="wistia_embed" style="display: none;" src="//fast.wistia.net/embed/iframe/'+o.video.id+'" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>';break;case"flowplayer":a='<div class="item active" style="display: block; opacity: 0;"></div>'}i=e(a).appendTo(te),"flowplayer"==o.video.provider?(n(o.video.src,".mp4")?l="video/mp4":n(o.video.src,".webm")?l="video/webm":n(o.video.src,".ogg")?l="video/ogg":n(o.video.src,".flv")&&(l="video/flash"),i.animate({opacity:1},200).flowplayer({swf:re.flowplayerSwf,tooltip:!1,embed:!1,key:re.flowplayer.key,logo:re.flowplayer.logo,clip:{sources:[{type:l,src:o.video.src}]}})):i.fadeIn(200),ae.stop(!0).fadeOut(500),oe.itemDisplay.resize();break;case"audio":t=te.find(">").removeClass("active").fadeOut(200,function(){t.remove()}),i=e('<div class="item active" style="display: block; opacity: 0;"><audio src="'+o.audio.src+'" /></div>').appendTo(te).animate({opacity:1},200),audiojs.create(e("> audio",i)[0]),ae.stop(!0).fadeOut(500),oe.itemDisplay.resize()}},arguments.length>0&&e.extend(!0,re,arguments[0]),this.each(function(){var t=e(this).data("socialMediaBox");t&&(t instanceof Array?e.each(t,function(){ce.push(this)}):ce.push(t))}),0==ce.length?this:(t=e("body").addClass("socialMediaBoxActive"),s=e('<div id="socialMediaBox" class="'+re.baseClass+'" style="visibility: hidden;"></div>').appendTo(t),oe.thubnails.init(),oe.itemDetails.init(),oe.itemDisplay.init(),oe.interfaceActions.init(),ce.length>1&&(ie=e('<div class="navigation previous '+(re.itemDetails.rightSide?"left":"right")+'"></div>').appendTo(s),se=e('<div class="navigation next '+(re.itemDetails.rightSide?"left":"right")+'"></div>').appendTo(s)),ne=e('<div class="close"><span></span></div>'),s.append(ne),oe.resize(),oe.showItem(re.openAt,!0),s.css({display:"none",visibility:""}).fadeIn(200).on("click","> div.navigation",function(){e(this).hasClass("previous")?oe.showItem(de.activeItem-1):oe.showItem(de.activeItem+1)}),ne.on("click",function(){oe.close()}),e(document).on("keyup.socialMediaBox",function(t){var a=e(document.activeElement);if(0!=a.filter("textarea").parents(".commentsWrapper").length||a.filter("input").parents(".commentsWrapper").length)return!1;switch(t.keyCode){case 37:oe.showItem(de.activeItem-1);break;case 39:oe.showItem(de.activeItem+1);break;case 27:oe.close()}return!1}),te.on("touchstart",function(e){"function"==typeof e.stopPropagation&&(e.stopPropagation(),e.preventDefault()),e.originalEvent.touches&&e.originalEvent.touches.length?e=e.originalEvent.touches[0]:e.originalEvent.changedTouches&&e.originalEvent.changedTouches.length&&(e=e.originalEvent.changedTouches[0]),de.itemDisplay.touch.newTouch=!0,de.itemDisplay.touch.startX=e.pageX,de.itemDisplay.touch.startY=e.pageY}).on("touchmove",function(e){var t;"function"==typeof e.stopPropagation&&(e.stopPropagation(),e.preventDefault()),de.itemDisplay.touch.newTouch&&(e.originalEvent.touches&&e.originalEvent.touches.length?e=e.originalEvent.touches[0]:e.originalEvent.changedTouches&&e.originalEvent.changedTouches.length&&(e=e.originalEvent.changedTouches[0]),t=de.itemDisplay.touch.startX-e.pageX,Math.abs(t)<50||(de.itemDisplay.touch.newTouch=!1,t>0?oe.showItem(de.activeItem+1):oe.showItem(de.activeItem-1)))}).on("touchend touchcancel",function(e){"function"==typeof e.stopPropagation&&(e.stopPropagation(),e.preventDefault()),de.itemDisplay.touch.newTouch=!1}),e(window).on("resize.socialMediaBox",function(){oe.resize()}),this)},e.fn.socialMediaBox4Journal=function(i){var n;if(!t)return t=!0,n=function(){var t,n,o,r,l=e(this),c=l.parents(".journalrow")[0].id,d="",p=e('<div id="socialMediaBox4JournalOverlay"'+("object"==typeof i.smbConfig&&i.smbConfig.baseClass?' class="'+i.smbConfig.baseClass+'"':"")+"><div></div><p></p></div>"),m=e("> p",p),u=e("> div",p),h=e("body"),v="",f=function(){e(document).off(".socialMediaBox4Journal"),p.fadeTo(400,0,function(){p.remove()}),h.removeClass("socialMediaBoxActive"),m.css("display","none")};h.append(p).addClass("socialMediaBoxActive"),p.fadeTo(400,1).on("click","> p > .close",function(){return f(),!1}),e.each(l.parents("#journalItems").eq(0).find(">").has(".journalitem > .jphoto"),function(e,t){t.id==c&&(i.smbConfig.openAt=e),d+=t.id.substring(t.id.indexOf("-")+1)+","}),d=d.substring(0,d.length-1),t=s(l.parents(".DnnModule-Journal").eq(0)),n=a(),r=e.ajax({data:{action:"journal_entries",journalIds:d,journalModuleId:t,journalType:n.type,journalTarget:n.target},dataType:"json",type:"POST",url:i.entriesUrl,timeout:15e3,cache:!1,error:function(){v=i.errors.generalError},success:function(e){"success"==e.status?0==(o=e.entries).length&&(v=i.errors.noJournalItems):v=e.message},complete:function(){if(""!=v)return u.fadeTo(200,0,function(){u.css("display","none")}),void m.html(v+'<span class="close">X</span>').css({display:"block",opacity:0}).fadeTo(200,1);f(),e("<div></div>").data("socialMediaBox",o).socialMediaBox(i.smbConfig)}}),e(document).on("keyup.socialMediaBox4Journal",function(e){if(27==e.keyCode)return r.abort(),f(),!1})},e(".DnnModule-Journal").on("click",".journalitem > .jphoto a",function(){return n.call(this),!1}).on("click",".journalitem > .jphoto > img",n).on("mouseenter",".journalitem > .jphoto > img",function(){e(this).css("cursor","pointer")}),this}}(eds3_5_jq)}();