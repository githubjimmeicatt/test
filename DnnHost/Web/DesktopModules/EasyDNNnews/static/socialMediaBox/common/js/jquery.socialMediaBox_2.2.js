!function(e){var t,a=!1,s=function(){var e,t=0,a="summary";return null!=(e=location.href.match(/\/userid\/\d+\//i))?(t=e[0].match(/\d+/)[0],a="profile"):null!=(e=location.href.match(/\/groupid\/\d+\//i))&&(t=e[0].match(/\d+/)[0],a="group"),{type:a,target:t}},n=function(e,t){return-1!==e.indexOf(t,e.length-t.length)};"undefined"!=typeof eds2_2&&((t=eds2_2).fn.socialMediaBox=function(){var a,o,r,l,c,d,p,m,u,h,v,f,g,y,b,w,k,C,I,D,x,T,j,_,A,M,q,z,W,B,S,O,H,R,P,E,L,$,U,N,J,Y,X,G,F,K,Z,Q,V,ee,te,ae,ie,se,ne,oe,re={},le={openAt:0,baseClass:"",localized:{},flowplayerSwf:"",flowplayer:{key:"",logo:""},thumbnails:{show:!0,width:100,height:100},itemDetails:{show:!0,rightSide:!0,comments:{notifySocialGroup:!1,requireAuthorInfo:!0,captcha:!0,permissions:{commenting:!0,editing:!1,deleting:!1}},socialButtons:{show:!1,buttons:{facebook:{show:!1,html:'<iframe src="//www.facebook.com/plugins/like.php?href={{encodedUrl}}&amp;send=false&amp;layout=button_count&amp;show_faces=true&amp;action=like&amp;colorscheme=light&amp;font&amp;height=21&amp;width=110" scrolling="no" frameborder="0" style="border:none; overflow:hidden; height:21px; width: 110px;" allowTransparency="true"></iframe>'},gplus:{show:!1,html:'<div class="g-plusone" data-size="medium" data-href="{{url}}"></div><script type="text/javascript">gapi.plusone.go();<\/script>'},twitter:{show:!1,html:'<a href="//twitter.com/share" class="twitter-share-button" data-url="{{url}}" data-text="{{escapedTitle}}">Tweet</a><script type="text/javascript">twttr.widgets.load();<\/script>'},inshare:{show:!1,html:'<script type="IN/Share" data-counter="right" data-url="{{url}}"><\/script><script type="text/javascript">IN.parse();<\/script>'},pinterest:{show:!1,html:'<a href="//pinterest.com/pin/create/button/?url={{encodedUrl}}&media={{encodedMediaUrl}}&description={{encodedTitle}}" class="pin-it-button" count-layout="horizontal"><img border="0" src="//assets.pinterest.com/images/PinExt.png" title="Pin It" /></a>'}}}},events:{onBeforeClose:function(){}},googleReCaptchaSiteKey:""},ce=function(e){return"string"==typeof le.localized[e]?le.localized[e]:e},de=[],pe={activeItem:0,resizeInProgress:!1,resizeRace:!1,interfaceHidden:!1,baseWrapper:{height:0,width:0},thumbnails:{rendered:!1,initialized:!1,thumbActivatedChange:!1,allThumbnailsLoaded:!1,thumbnail:{height:0,width:0},wrapper:{height:0,effectiveHeight:0},overview:{width:0}},interfaceActions:{wrapper:{height:0}},itemDetails:{rendered:!1,wrapper:{verticalOffset:0,width:0,effectiveWidth:0},comments:{author:{avatarContainer:null}},maps:{google:null}},itemDisplay:{wrapper:{verticalOffset:0,horizontalOffset:0,height:0,width:0},touch:{newTouch:!1,startX:0,startY:0}},preloadedImages:{},commentsCache:{},reCaptchaId:e},me=function(t,a){a?(pe.preloadedImages[t].state="success",pe.preloadedImages[t].width=this.naturalWidth===e?this.width:this.naturalWidth,pe.preloadedImages[t].height=this.naturalHeight===e?this.height:this.naturalHeight):pe.preloadedImages[t].state="error",clearTimeout(pe.preloadedImages[t].timeout)},ue=function(e){for(var t=pe.preloadedImages[e].callbacks;t.length>0;)t.splice(0,1)[0]();pe.preloadedImages[e].callbacks=[]};return terminated=!1,re.preloadImage=function(a,i){var s=t("<img />"),n=s[0],o=!1,r="number"==typeof i?i:0;if(0==r){if(pe.preloadedImages[a]!==e)return void("loading"==pe.preloadedImages[a].state?pe.preloadedImages[a].callbacks.push(i):i());pe.preloadedImages[a]={state:"loading",callbacks:[i]}}if(pe.preloadedImages[a].timeout=setTimeout(function(){!terminated&&r<10&&re.preloadImage(a,r+1)},4e3*(r+1)),s.bind("load.socialMediaBox error.socialMediaBox",function(e){o||"loading"!=pe.preloadedImages[a].state||(me.apply(n,[a,"load"==e.type]),ue(a))}),n.src=a,n.complete&&n.naturalWidth!==e)return o=!0,me.apply(n,[a,0!==n.naturalWidth&&0!==n.naturalHeight]),void ue(a)},re.resize=function(){var e,t,a,i,s,n;pe.resizeInProgress?pe.resizeRace=!0:(pe.resizeInProgress=!0,pe.baseWrapper.height=o.height(),pe.baseWrapper.width=o.width(),re.thubnails.resize(),re.itemDetails.resize(),re.itemDisplay.resize(),re.interfaceActions.resize(),de.length>1&&(e=Math.floor((pe.itemDisplay.wrapper.height+pe.itemDisplay.wrapper.verticalOffset-se.height())/2),t=pe.itemDisplay.wrapper.width+pe.itemDisplay.wrapper.horizontalOffset-ne.outerWidth(!0),le.itemDetails.rightSide?(a={top:e,left:0,right:"auto"},i={top:e,left:t,right:"auto"}):(a={top:e,left:"auto",right:t},i={top:e,left:"auto",right:0}),se.css(a),ne.css(i)),n=pe.itemDisplay.wrapper.width+pe.itemDisplay.wrapper.horizontalOffset-oe.outerWidth(!0),s=le.itemDetails.rightSide?{left:n,right:"auto"}:{left:"auto",right:n},oe.css(s),pe.resizeInProgress=!1,pe.resizeRace&&(pe.resizeRace=!1,re.resize()))},re.showItem=function(e,t){e<0?e=de.length-1:e>=de.length&&(e=0),!0!==t&&pe.activeItem==e||(pe.activeItem=e,re.itemDisplay.showItem(),re.itemDetails.showItem(),re.thubnails.showItem())},re.callbackObject=function(){return{activeItem:pe.activeItem,displayItems:de}},re.close=function(){"function"==typeof le.events.onBeforeClose&&!1===le.events.onBeforeClose(re.callbackObject())||(terminated=!0,t(document).off(".socialMediaBox"),t(window).off(".socialMediaBox"),o.fadeOut(200,function(){o.remove(),a.removeClass("socialMediaBoxActive")}))},re.thubnails={},re.thubnails.init=function(){var a;!le.thumbnails.show||de.length<2||(pe.thumbnails.rendered=!0,r=t('<div class="thumbnailsMainWrapper"><div class="scrollbar"><div class="track"><div class="thumb"><div class="end"></div></div></div></div><div class="viewport"><div class="overview"></div></div></div>'),l=t("> div.viewport",r),c=t("> div.overview",l),t.each(de,function(a,i){var s=t('<div><div class="'+i.type+'">'+("video"==i.type||"audio"==i.type?'<div class="playItem"></div>':"")+"</div></div>").appendTo(c);i.thumbnail!==e&&i.thumbnail.src!==e?re.preloadImage(i.thumbnail.src,function(){var e,t,a,n,o=le.thumbnails.height,r=le.thumbnails.width,l=r/o;"success"==pe.preloadedImages[i.thumbnail.src].state&&(t=pe.preloadedImages[i.thumbnail.src].height,a=pe.preloadedImages[i.thumbnail.src].width,(t>o||a>r)&&((n=a/t)<l?(a=Math.round(o/t*a),t=o):n>l?(t=Math.round(r/a*t),a=r):(a=r,t=o)),e=t>o?0:Math.floor((o-t)/2),s.css("top",e).fadeIn(300).addClass("visible").find("> div").prepend('<img src="'+i.thumbnail.src+'" alt="" style="height: '+t+"px; width: "+a+'px;" />'),pe.thumbnails.initialized&&re.thubnails.resize())}):s.fadeIn(300).addClass("visible").find("> div").prepend('<div class="noThumb"></div>')}),a=t("> div",c).eq(0),r.appendTo(o),t(">",a).css({width:le.thumbnails.width,height:le.thumbnails.height}),pe.thumbnails.thumbnail.height=a.outerHeight(!0),pe.thumbnails.thumbnail.width=a.outerWidth(!0),t(">",a).css({width:"",height:""}),c.height(pe.thumbnails.thumbnail.height),l.height(pe.thumbnails.thumbnail.height),pe.thumbnails.wrapper.height=pe.thumbnails.wrapper.effectiveHeight=r.outerHeight(!0),r.eds_tinyscrollbar({axis:"x"}),c.on("click","> div",function(){pe.thumbnails.thumbActivatedChange=!0,re.showItem(t(this).index())}),pe.thumbnails.initialized=!0)},re.thubnails.resize=function(){var e,a,i,s=0,n=pe.thumbnails.thumbnail.width;!le.thumbnails.show||de.length<2||(pe.thumbnails.thumbActivatedChange?pe.thumbnails.thumbActivatedChange=!1:(pe.thumbnails.allThumbnailsLoaded||(i=t("> div.visible",c),de.length==i.length&&(pe.thumbnails.allThumbnailsLoaded=!0),pe.thumbnails.overview.width=0,i.each(function(){pe.thumbnails.overview.width+=t(this).outerWidth(!0)}),c.width(pe.thumbnails.overview.width)),e=r.width(),(a=pe.thumbnails.overview.width)>e?(c.css({left:0}),(s=n*pe.activeItem+Math.floor(n/2))<=Math.floor(e/2)?s=0:a-s<=Math.ceil(e/2)?s="bottom":s-=Math.floor(e/2),r.data("plugin_eds_tinyscrollbar").update(s)):(r.data("plugin_eds_tinyscrollbar").update(),c.css({left:Math.floor((e-a)/2)}))))},re.thubnails.showItem=function(){!le.thumbnails.show||de.length<2||(t("> div",c).removeClass("active").eq(pe.activeItem).addClass("active"),re.thubnails.resize())},re.interfaceActions={},re.interfaceActions.init=function(){var e;d=t('<div class="interfaceActionsWrapper"></div>'),(pe.thumbnails.rendered||pe.itemDetails.rendered)&&(p=t('<div class="action toggleInterface"><span>'+ce("Hide interface")+"</span></div>").appendTo(d).on("click",function(){var t,a;pe.interfaceHidden?(pe.interfaceHidden=!1,e.text(ce("Hide interface")),p.removeClass("hidden")):(pe.interfaceHidden=!0,e.text(ce("Show interface")),p.addClass("hidden")),pe.thumbnails.rendered&&(t=pe.interfaceHidden?-pe.thumbnails.wrapper.height:0,r.stop(!0).animate({bottom:t},{duration:200,step:function(e){pe.thumbnails.wrapper.effectiveHeight=Math.round(pe.thumbnails.wrapper.height+e),re.resize()}})),pe.itemDetails.rendered&&(a=le.itemDetails.rightSide?pe.interfaceHidden?{right:-pe.itemDetails.wrapper.width}:{right:0}:pe.interfaceHidden?{left:-pe.itemDetails.wrapper.width}:{left:0},m.stop(!0).animate(a,{duration:200,step:function(e){pe.itemDetails.wrapper.effectiveWidth=Math.round(pe.itemDetails.wrapper.width+e),re.resize()}}))}),e=t("> span",p)),o.append(d),pe.interfaceActions.wrapper.height=d.outerHeight(!0)},re.interfaceActions.resize=function(){d.css({bottom:pe.thumbnails.wrapper.effectiveHeight})},re.itemDetails={comments:{}},re.itemDetails.init=function(){var a='<div class="commentsWrapper">\t\t\t\t\t<h3>'+ce("Comments")+'</h3>\t\t\t\t\t<div class="loading"></div>\t\t\t\t\t<p class="message"></p>\t\t\t\t\t<div class="commentsList"></div>\t\t\t\t\t<div class="addCommentContainer">\t\t\t\t\t\t<div class="commentingMessage"></div>\t\t\t\t\t\t<div class="authorInfo name"><div class="text"><span class="label">'+ce("Name")+'</span><input type="text" value="" /></div></div>\t\t\t\t\t\t<div class="authorInfo email"><div class="text"><span class="label">'+ce("Email")+'</span><input type="text" value="" /></div></div>\t\t\t\t\t\t<div class="textarea"><textarea></textarea></div>\t\t\t\t\t\t<div class="captchaContainer"><div class="captcha"></div></div>\t\t\t\t\t\t<button class="add"><span>'+ce("Add comment")+"</span></button>\t\t\t\t\t</div>\t\t\t\t</div>",n='<div class="authorWrapper">\t\t\t\t\t<div class="avatarWrapper">\t\t\t\t\t\t<div class="avatarContainer"></div>\t\t\t\t\t</div>\t\t\t\t\t<div class="actions">\t\t\t\t\t\t<button class="follow"><span>'+ce("follow")+'</span></button>\t\t\t\t\t\t<button class="friend"><span>'+ce("add as friend")+'</span></button>\t\t\t\t\t\t<button class="friend rejectRequest"><span>'+ce("reject friend request")+'</span></button>\t\t\t\t\t</div>\t\t\t\t\t<p class="postedBy">'+ce("posted by")+'</p>\t\t\t\t\t<p class="name"></p>\t\t\t\t\t<p class="date"></p>\t\t\t\t</div>',r='<div class="likeWrapper">\t\t\t\t\t<div class="likeContainer">\t\t\t\t\t\t<button><span>'+ce("like")+'</span></button>\t\t\t\t\t\t<p></p>\t\t\t\t\t</div>\t\t\t\t\t<ul class="alsoLiked"></ul>\t\t\t\t</div>',l='<div class="buttonsWrapper">\t\t\t\t\t<a href="#" class="email"><span>'+ce("Send link")+'</span></a>\t\t\t\t\t<a href="#" target="_blank" class="download"><span>'+ce("Download")+"</span></a>\t\t\t\t</div>",c='<div class="metaWrapper"><h3><span>'+ce("Details")+'</span></h3><div class="content"></div></div>';le.itemDetails.show&&(m=t('<div class="itemDetailsWrapper '+(le.itemDetails.rightSide?"right":"left")+'"><div class="viewport"><div class="overview"><h2></h2><div class="description"></div>'+n+r+'<div class="socialButtonsWrapper"></div><div class="ratingWrapper">\t\t\t\t\t<div class="starContainer">\t\t\t\t\t\t<div></div>\t\t\t\t\t</div>\t\t\t\t\t<p class="score"></p>\t\t\t\t\t<p class="message"></p>\t\t\t\t</div><ul class="tagContainer"></ul>'+l+a+c+'</div></div><div class="scrollbar"><div class="track"><div class="thumb"><div class="end"></div></div></div></div></div>'),u=t("> .viewport",m),h=t("> .overview",u),v=t("> h2",h),f=t("> div.description",h),g=t("> .authorWrapper",h),y=t("> .avatarWrapper",g),b=t("> .avatarContainer",y),w=t("> .name",g),k=t("> .date",g),C=t("> .actions",g),I=t("> .follow",C),D=t("> .friend",C).eq(0),x=t("> .friend",C).eq(1),T=t("> .likeWrapper",h),j=t("> .likeContainer",T),_=t("> button",j),A=t("> p",j),M=t("> .alsoLiked",T),q=t("> .socialButtonsWrapper",h),z=t("> .ratingWrapper",h),W=t("p.score",z),B=t("p.message",z),S=t("> div.starContainer",z),O=t("> div",S),H=t("> .tagContainer",h),R=t("> .buttonsWrapper",h),P=t("> .download",R),E=t("> .email",R),L=t("> div.commentsWrapper",h),$=t("> p.message",L),U=t("> div.commentsList",L),N=t("> div.loading",L),J=t("> div.addCommentContainer",L),Y=t("> button.add",J),X=t("> div > textarea",J),G=t("> .commentingMessage",J),F=t("> .authorInfo",J),K=t("> .text",F),Z=t("> div.captchaContainer",J),Q=t("> .metaWrapper",h),V=t("> h3",Q),ee=t("> .content",Q),o.append(m),pe.itemDetails.wrapper.verticalOffset=m.outerHeight(!0)-m.height(),pe.itemDetails.wrapper.width=pe.itemDetails.wrapper.effectiveWidth=m.outerWidth(!0),q.css("display",le.itemDetails.socialButtons.show?"block":"none"),K.click(function(){var e=t(this);return t("> input",e).focus(),!1}),t("> input",K).focus(function(){var e=t(this).siblings("span");""==this.value&&e.stop(!0).fadeTo(200,0,function(){e.css("display","none")})}).blur(function(){""==this.value&&t(this).siblings("span").stop(!0).css("display","").fadeTo(200,1)}),Y.on("click",function(){var a,i,n,o=X.val(),r=pe.activeItem,l=de[r],c="",d={},p={},u=[],h="",v=s(),f={action:"add_comment",journalType:v.type,journalTarget:v.target};if(!J.hasClass("sending")){if(le.itemDetails.comments.notifySocialGroup&&(f.notifySocialGroup=!0,f.journalModuleId=0),le.itemDetails.comments.requireAuthorInfo&&(a=t("> div > input",F.filter(".name")).val(),i=t("> div > input",F.filter(".email")).val(),""===a&&u.push(ce("a name")),""!==i&&/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(i)||u.push(ce("a valid email address"))),""==o&&u.push(ce("a comment")),le.itemDetails.comments.requireAuthorInfo&&le.itemDetails.comments.captcha&&""===(n=grecaptcha.getResponse(pe.reCaptchaId))&&u.push(ce("the captcha")),0!==u.length)return h="<p>"+ce("Please specify")+" ",t.each(u,function(e,t){e>0&&(e+1==u.length?h+=" "+ce("and")+" ":h+=", "),h+=t}),h+="</p>",G.css("display","block").removeClass("positive").html(h).addClass("negative"),void m.data("plugin_eds_tinyscrollbar").update("relative");X[0].disabled=!0,J.addClass("sending"),G.css("display","block").removeClass("negative positive").html("<p>"+ce("Sending...")+"</p>"),f.comment=o,le.itemDetails.comments.requireAuthorInfo&&(f.name=a,f.email=i,le.itemDetails.comments.captcha&&(f.captcha=n)),t.ajax({data:f,dataType:"json",type:"POST",url:l.comments.backend,timeout:15e3,cache:!1,error:function(){c=ce("The comment can't currently be saved. Please try again later.")},success:function(t){if(t.status!=e)switch(t.status){case"success":d.author=t.author.id,d.content=t.comment,d.raw=o,d.id=t.id,d.dateHtml=t.dateHtml,pe.commentsCache[l.comments.backend].comments.push(d),p=pe.commentsCache[l.comments.backend].authors[d.author]==e?pe.commentsCache[l.comments.backend].authors[d.author]={avatar:t.author.avatar,name:t.author.name,url:t.author.url}:pe.commentsCache[l.comments.backend].authors[d.author];break;case"error":c=t.message;break;case"captcha_error":c=t.message}else c=ce("The comment can't currently be saved. Please try again later.")},complete:function(){r==pe.activeItem&&(""==c?(U.css("display","block"),$.css("display","none"),re.itemDetails.comments.renderCommentBox(d,p),re.itemDetails.comments.setAvatarContainerDimensions(),re.itemDetails.comments.loadAvatars(d.author,p),X.val(""),G.css("display","none")):G.css("display","block").addClass("negative").html("<p>"+c+"</p>"),J.removeClass("sending"),X[0].disabled=!1,le.itemDetails.comments.requireAuthorInfo&&le.itemDetails.comments.captcha&&grecaptcha.reset(pe.reCaptchaId),m.data("plugin_eds_tinyscrollbar").update("relative"))}}),m.data("plugin_eds_tinyscrollbar").update("relative")}}),U.on("click",".actionsBoxTrigger li.edit",function(){var e,a=t(this).parents().eq(2),i=t("> .content",a),s=!1,n=de[pe.activeItem];return s="object"==typeof n.comments&&"object"==typeof n.comments.permissions&&"boolean"==typeof n.comments.permissions.editing?n.comments.permissions.editing:le.itemDetails.comments.permissions.editing,!(a.data("editing")||!s||(clearTimeout(a.data("saveMsgTimeout")),a.data("editing",!0),t("> .editor",a).remove(),i.css("display","none"),e=t('<div class="editor"><div class="textarea"><textarea style="height: '+i.height()+'px;"></textarea></div><div class="actions"><p></p><span class="save">'+ce("Save")+'</span><span class="cancel">'+ce("Cancel")+"</span></div></div>").appendTo(a),t(".textarea > textarea",e).val(a.data("comment").raw).focus(),m.data("plugin_eds_tinyscrollbar").update("relative"),1))}).on("click",".editor > .actions > span",function(){var a,i,s,n,o=t(this),r=o.parent(),l=o.parents().eq(2),c=l.data("comment"),d="",p=pe.activeItem,u=de[p],h={};if(l.data("saving"))return!1;if(o.hasClass("save")){if(s=t("> .editor > .textarea > textarea",l),""==(n=s.val()))return i=t("> p",r).text(ce("Please specify a comment")).addClass("negative").removeClass("positive").css("display","block"),void m.data("plugin_eds_tinyscrollbar").update("relative");l.data("saving",!0),s[0].disabled=!0,i=t("> p",r).text(ce("Saving...")).removeClass("negative positive").css("display","block"),a=t("> span",r).css("display","none"),t.ajax({data:{action:"edit_comment",id:c.id,comment:n},dataType:"json",type:"POST",url:u.comments.backend,timeout:15e3,cache:!1,error:function(){d=ce("Your changes can't currently be saved.")},success:function(a){if(a.status!=e)switch(a.status){case"success":h=t.extend(!0,{},c,{raw:n,content:a.comment,dateHtml:a.dateHtml}),t.each(pe.commentsCache[u.comments.backend].comments,function(e,t){if(t.id==c.id)return pe.commentsCache[u.comments.backend].comments[e]=h,!1});break;case"error":d=a.message}else d=ce("Your changes can't currently be saved.")},complete:function(){p==pe.activeItem&&(d?(s[0].disabled=!1,a.css("display",""),i.addClass("negative").text(d)):(i.addClass("positive").text(ce("Your changes were saved")),t("> .editor > .textarea",l).remove(),t("> .content",l).css("display","block").html(h.content),t("> .meta > .commentDate",l).html(h.dateHtml),l.data({editing:!1,comment:h,saveMsgTimeout:setTimeout(function(){terminated||p!=pe.activeItem||t("> .editor",l).remove(),m.data("plugin_eds_tinyscrollbar").update("relative")},3e3)})),l.data("saving",!1),m.data("plugin_eds_tinyscrollbar").update("relative"))}})}else l.data("editing",!1),t("> .editor",l).remove(),t("> .content",l).css("display","block");return m.data("plugin_eds_tinyscrollbar").update("relative"),!1}).on("click",".actionsBoxTrigger li.delete",function(){var e=t(this).parents().eq(2);return e.addClass("hideActions"),t("> .deleteConfirmation",e).css("display","block"),m.data("plugin_eds_tinyscrollbar").update("relative"),!1}).on("click",".deleteConfirmation span",function(){var a=t(this),i=a.parents().eq(2),s=(i.index(),i.data("comment")),n=t("> .deleteConfirmation",i),o=t("> .message",n),r="",l=pe.activeItem,c=de[l];return a.hasClass("delete")?(t("> p",n).css("display","none"),o.text(ce("Deleting...")).css("display","block"),t.ajax({data:{action:"delete_comment",id:s.id},dataType:"json",type:"GET",url:c.comments.backend,timeout:15e3,cache:!1,error:function(){r=ce("The comment can't currently be deleted.")},success:function(a){if(a.status!=e)switch(a.status){case"success":t.each(pe.commentsCache[c.comments.backend].comments,function(e,t){if(t.id==s.id)return pe.commentsCache[c.comments.backend].comments.splice(e,1),!1});break;case"error":r=a.message}else r=ce("Your changes can't currently be saved.")},complete:function(){l==pe.activeItem&&(r?(o.addClass("negative").text(r),i.removeClass("hideActions")):(i.remove(),0==t(">",U).length&&(U.css("display","none"),$.addClass("noComments").text(ce("No comments yet")).css("display","block"))),m.data("plugin_eds_tinyscrollbar").update("relative"))}})):(i.removeClass("hideActions"),n.css("display","none"),o.css("display","none")),m.data("plugin_eds_tinyscrollbar").update("relative"),!1}),S.on("mousemove",function(t){var a,i,s=de[pe.activeItem],n=S.offset();s.rating.rated||s.rating.backend==e||(a=S.width()/5,i=Math.ceil((t.clientX-n.left)/a),S.data("stars",i),O.css("width",a*i+"px"))}).on("mouseleave",function(){var t=de[pe.activeItem],a=t.rating.score;t.rating.backend!=e&&(!1!==t.rating.rated&&(a=t.rating.rated),O.css("width",a/5*100+"%"))}).on("click",function(){var a=pe.activeItem,i=de[a],s=!1,n=ce("Rating is currently not possible.");!1===i.rating.rated&&i.rating.backend!=e&&(de[a].rating.rated=S.data("stars"),S.addClass("rated"),O.css("width",i.rating.rated/5*100+"%"),t.ajax({data:{action:"rate",rating:i.rating.rated},dataType:"json",type:"POST",url:i.rating.backend,timeout:15e3,cache:!1,error:function(){s=n},success:function(t){if(t.status!=e)switch(t.status){case"success":de[a].rating.score=t.score;break;case"error":s=t.message}else s=n},complete:function(){s&&(de[a].rating.rated=!1),a==pe.activeItem&&(s?(S.removeClass("rated"),O.css("width",de[a].rating.score/5*100+"%"),B.addClass("negative").css("display","block").text(s)):W.removeClass("noRatings").text(de[a].rating.score),m.data("plugin_eds_tinyscrollbar").update("relative"))}}))}),I.on("click",function(){var a=pe.activeItem,s=de[a],n=!1,o=!s.author.following;!0!==I.data("disabled")&&(I.data("disabled",!0).addClass("requesting"),t.ajax({data:{action:"follow",follow:o},dataType:"json",type:"POST",url:s.author.backend,timeout:1e4,cache:!1,error:function(){n=!0},success:function(t){if(t.status!=e)switch(t.status){case"success":for(i in de)"object"==typeof de[i].author&&void 0!==de[i].author.id&&de[i].author.id==s.author.id&&(de[i].author.following=o);break;case"error":n=!0}else n=!0},complete:function(){a==pe.activeItem&&(I.data("disabled",!1).removeClass("requesting"),n||(o?I.addClass("unfollow").find("> span").text(ce("unfollow")):I.removeClass("unfollow").find("> span").text(ce("follow"))),m.data("plugin_eds_tinyscrollbar").update("relative"))}}),m.data("plugin_eds_tinyscrollbar").update("relative"))}),D.on("click",function(){var a,s=pe.activeItem,n=de[s],o=!1;!0!==D.data("disabled")&&(D.data("disabled",!0).addClass("requesting"),"requested_by_author"==n.author.friends?(x.addClass("requesting"),a=!0):a=!0!==n.author.friends&&"requested_by_user"!=n.author.friends,t.ajax({data:{action:"friend",friends:a},dataType:"json",type:"POST",url:n.author.backend,timeout:1e4,cache:!1,error:function(){o=!0},success:function(t){if(t.status!=e)switch(t.status){case"success":a=t.friends;for(i in de)"object"==typeof de[i].author&&void 0!==de[i].author.id&&de[i].author.id==n.author.id&&(de[i].author.friends=a);break;case"error":o=!0}else o=!0},complete:function(){s==pe.activeItem&&(D.data("disabled",!1).removeClass("requesting"),x.removeClass("requesting"),o||(x.css("display","none"),D.removeClass("unfriend cancelRequest acceptRequest"),!0===a?D.addClass("unfriend").find("> span").text(ce("unfriend")):"requested_by_user"==a?D.addClass("cancelRequest").find("> span").text(ce("cancel friend request")):D.find("> span").text(ce("add as friend"))),m.data("plugin_eds_tinyscrollbar").update("relative"))}}),m.data("plugin_eds_tinyscrollbar").update("relative"))}),x.on("click",function(){var a=pe.activeItem,s=de[a],n=!1;"requested_by_author"==s.author.friends&&!0!==D.data("disabled")&&(D.data("disabled",!0).addClass("requesting"),x.addClass("requesting"),t.ajax({data:{action:"friend",friends:!1},dataType:"json",type:"POST",url:s.author.backend,timeout:1e4,cache:!1,error:function(){n=!0},success:function(t){if(t.status!=e)switch(t.status){case"success":for(i in de)"object"==typeof de[i].author&&void 0!==de[i].author.id&&de[i].author.id==s.author.id&&(de[i].author.friends=!1);break;case"error":n=!0}else n=!0},complete:function(){a==pe.activeItem&&(D.data("disabled",!1).removeClass("requesting unfriend cancelRequest acceptRequest"),x.removeClass("requesting"),n||(x.css("display","none"),D.find("> span").text(ce("add as friend"))),m.data("plugin_eds_tinyscrollbar").update("relative"))}}),m.data("plugin_eds_tinyscrollbar").update("relative"))}),_.on("click",function(){var a=pe.activeItem,i=de[a],s=!1,n=!i.likes.liked;!0!==_.data("disabled")&&(_.data("disabled",!0).addClass("requesting"),t.ajax({data:{action:"like",liked:n},dataType:"json",type:"POST",url:i.likes.backend,timeout:1e4,cache:!1,error:function(){s=!0},success:function(t){if(t.status!=e)switch(t.status){case"success":de[a].likes.liked=n,de[a].likes.message=t.message;break;case"error":s=!0}else s=!0},complete:function(e){var i;if(a==pe.activeItem){if(_.data("disabled",!1).removeClass("requesting"),s){try{i=t.parseJSON(e.responseText).message}catch(e){i=ce("An error occurred while "+(n?"saving your like":"removing your like"))}A.addClass("negative").text(i)}else A.removeClass("negative").text(de[a].likes.message),n?_.addClass("unlike").find("> span").text(ce("unlike")):_.removeClass("unlike").find("> span").text(ce("like"));m.data("plugin_eds_tinyscrollbar").update("relative")}}}),m.data("plugin_eds_tinyscrollbar").update("relative"))}),V.on("click",function(){var e=de[pe.activeItem],t="block";ee.is(":visible")&&(t="none"),ee.css("display",t),"block"==t?(V.addClass("close"),"object"==typeof e.meta.map&&"google"==e.meta.map.type&&(google.maps.event.trigger(pe.itemDetails.maps.google,"resize"),pe.itemDetails.maps.google.setCenter(new google.maps.LatLng(e.meta.map.settings.lat,e.meta.map.settings.lng)))):V.removeClass("close"),m.data("plugin_eds_tinyscrollbar").update("relative")}),pe.itemDetails.rendered=!0,m.eds_tinyscrollbar({axis:"y"}))},re.itemDetails.placeAvatar=function(t){var a,i,s,n,o=0,r=0,l=null,c=null,d=pe.preloadedImages[t.src];if(t.fadeIn==e&&(t.fadeIn=!1),d===e||"loading"==d.state)return t.fadeIn=!0,void re.preloadImage(t.src,function(){re.itemDetails.placeAvatar(t)});"object"==typeof t.containerDimensions?(a=t.containerDimensions.height,i=t.containerDimensions.width):(a=t.$container.height(),i=t.$container.width()),"success"==d.state&&(l=d.height+4,c=d.width+4,(l>a||c>i)&&((n=c/l)<(s=i/a)?(c=Math.round(a/l*c),l=a):n>s?(l=Math.round(i/c*l),c=i):(c=i,l=a)),r=l==a?0:Math.floor((a-l)/2),o=c==i?0:Math.floor((i-c)/2),l-=4,c-=4),t.$container.append('<img src="'+t.src+'" alt="" style="'+(t.fadeIn?"display: none; ":"")+(null!=c?"width: "+c+"px; ":"")+(null!=l?"height: "+l+"px; ":"")+"top: "+r+"px; left: "+o+'px;" />'),t.fadeIn&&t.$container.find(">").fadeIn(200)},re.itemDetails.comments.renderCommentBox=function(e,a){var i,s,n,o=de[pe.activeItem],r=!1,l=!1;r="object"==typeof o.comments&&"object"==typeof o.comments.permissions&&"boolean"==typeof o.comments.permissions.editing?o.comments.permissions.editing:le.itemDetails.comments.permissions.editing,l="object"==typeof o.comments&&"object"==typeof o.comments.permissions&&"boolean"==typeof o.comments.permissions.deleting?o.comments.permissions.deleting:le.itemDetails.comments.permissions.deleting,i=(r&&!0!==o.journalEntry?'<li class="edit"><span>'+ce("Edit")+"</span></li>":"")+(l?'<li class="delete"><span>'+ce("Delete")+"</span></li>":""),n="string"==typeof a.url&&""!=a.url?'<a href="'+a.url+'">'+a.name+"</a>":a.name,s=t('<div class="author-'+e.author+("string"==typeof a.avatar&&""!=a.avatar?" hasAvatar":"")+'"><div class="deleteConfirmation"><p class="message"></p><p>'+ce("Do you really want to delete this comment?")+'</p><p><span class="delete">'+ce("Yes")+'</span><span class="cancel">'+ce("No")+'</span></p></div><div class="meta"><div class="authorAvatarWrapper"><div class="authorAvatarContainer"></div></div><h4>'+n+'</h4><p class="commentDate">'+e.dateHtml+'</p></div><div class="content">'+e.content+"</div>"+(""==i?"":'<div class="actionsBoxTrigger"><ul>'+i+"</ul></div>")+"</div>").data("comment",e),U.append(s)},re.itemDetails.comments.loadAvatars=function(a,i){var s,n=t("> .author-"+a+" > .meta > .authorAvatarWrapper",U).filter(":hidden");0!=n.lenght&&i.avatar!==e&&""!=i.avatar&&(n.css("display","block"),"string"==typeof i.url&&""!=i.url?(t(">",n).append(t('<a href="#" />').attr("href",i.url)),s=t("> >",n)):s=t(">",n),re.itemDetails.placeAvatar({src:i.avatar,$container:s,containerDimensions:pe.itemDetails.comments.author.avatarContainer}))},re.itemDetails.comments.setAvatarContainerDimensions=function(){null==pe.itemDetails.comments.author.avatarContainer&&($authorAvatarWrapper=t(".authorAvatarWrapper",U).eq(0).css("display","block"),pe.itemDetails.comments.author.avatarContainer={width:$authorAvatarWrapper.width(),height:$authorAvatarWrapper.height()},$authorAvatarWrapper.css("display","none"))},re.itemDetails.comments.display=function(e){var a=de[pe.activeItem];N.css("display","none"),e.comments.length>0?($.css("display","none"),U.empty(),t.each(e.comments,function(t,a){re.itemDetails.comments.renderCommentBox(a,e.authors[a.author])}),U.css("display","block"),re.itemDetails.comments.setAvatarContainerDimensions(),t.each(e.authors,re.itemDetails.comments.loadAvatars)):(U.empty().css("display","none"),$.addClass("noComments").text(ce("No comments yet")).css("display","block")),("object"==typeof a.comments&&"object"==typeof a.comments.permissions&&"boolean"==typeof a.comments.permissions.commenting?a.comments.permissions.commenting:le.itemDetails.comments.permissions.commenting)?(le.itemDetails.comments.requireAuthorInfo?(F.css("display","block"),le.itemDetails.comments.captcha&&(Z.css("display","block"),pe.reCaptchaId?grecaptcha.reset(pe.reCaptchaId):pe.reCaptchaId=grecaptcha.render(t("> .captcha",Z)[0],{sitekey:le.googleReCaptchaSiteKey,size:"compact"}))):(F.css("display","none"),Z.css("display","none")),J.removeClass("sending").css("display","block"),X[0].disabled=!1,G.css("display","none"),X.val("")):J.css("display","none")},re.itemDetails.showItem=function(){var a,i,s,n=pe.activeItem,o=de[n],r="",l=!1,c="",d="",p="",u="",h="";if(le.itemDetails.show){if(o.title==e||""==o.title?(v.css("display","none"),f.removeClass("withTitle")):(v.text(o.title).css("display","block"),f.addClass("withTitle")),o.description==e||""==o.description?f.css("display","none"):f.html(o.description).css("display","block"),le.itemDetails.socialButtons.show&&"object"==typeof o.social&&""!=o.social.url?(d="string"!=typeof o.social.media?"":o.social.media,t.each(le.itemDetails.socialButtons.buttons,function(e,t){if(t.show){if("pinterest"==e&&""==d)return;if("twitter"==e&&("undefined"==typeof twttr||void 0===twttr.widgets))return;if("inshare"==e&&("undefined"==typeof IN||"function"!=typeof IN.parse))return;c+="<div>"+t.html+"</div>"}}),""==c?q.css("display","none").empty():("string"==typeof o.title&&""!=o.title?(h=o.title.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),c=c.replace(/{{encodedTitle}}/g,encodeURIComponent(o.title))):c=c.replace(/{{encodedTitle}}/g,""),c=c.replace(/{{url}}/g,o.social.url).replace(/{{escapedTitle}}/g,h).replace(/{{encodedUrl}}/g,encodeURIComponent(o.social.url)),d&&(c=c.replace(/{{encodedMediaUrl}}/g,encodeURIComponent(d))),q.css("display","block").html(c),d&&le.itemDetails.socialButtons.buttons.pinterest.show&&t.ajax({url:"//assets.pinterest.com/js/pinit.js",dataType:"script",cache:!1}))):q.css("display","none").empty(),"object"==typeof o.rating?(S.removeClass("rated"),o.rating.score>0?(W.removeClass("noRatings").text(o.rating.score),!1===o.rating.rated?a=o.rating.score:(a=o.rating.rated,S.addClass("rated")),O.css("width",a/5*100+"%")):(W.addClass("noRatings").text(ce("No ratings")),O.css("width","")),B.css("display","none").removeClass("negative"),z.css("display","block"),o.rating.backend==e?z.addClass("cantRate"):z.removeClass("cantRate")):z.css("display","none"),"object"!=typeof o.comments||o.comments.backend==e||""==o.comments.backend?L.css("display","none"):(L.css("display","block"),U.css("display","none"),$.removeClass("noComments negative").css("display","none"),J.css("display","none"),pe.commentsCache[o.comments.backend]==e?(N.css("display","block"),t.ajax({data:{action:"list_comments"},dataType:"json",type:"GET",url:o.comments.backend,timeout:15e3,cache:!1,error:function(){n==pe.activeItem&&$.addClass("negative").removeClass("noComments").text(ce("Comments are currently unavalible")).css("display","block")},success:function(e){pe.commentsCache[o.comments.backend]=e,n==pe.activeItem&&(re.itemDetails.comments.display(e),m.data("plugin_eds_tinyscrollbar").update())}})):re.itemDetails.comments.display(pe.commentsCache[o.comments.backend])),"object"==typeof o.author?(g.css("display","block"),u="string"==typeof o.author.url&&""!=o.author.url?o.author.url:"","string"==typeof o.author.avatar&&""!=o.author.avatar?(y.css("display","block"),b.empty(),s=""==u?b:t('<a href="#" />').appendTo(b).attr({href:u}),re.itemDetails.placeAvatar({src:o.author.avatar,$container:s})):y.css("display","none"),w.empty(),""==u?w.text(o.author.name):w.append(t("<a />").attr({href:u}).text(o.author.name)),k.html(o.author.dateHtml),o.author.isUser!=e&&o.author.isUser?C.css("display","none"):(C.css("display","block"),o.author.following==e?I.css("display","none"):(I.data("disabled",!1).css("display","block"),o.author.following?I.addClass("unfollow").find("> span").text(ce("unfollow")):I.removeClass("unfollow").find("> span").text(ce("follow"))),x.css("display","none").removeClass("requesting"),o.author.friends==e?D.css("display","none"):(D.removeClass("requesting unfriend cancelRequest acceptRequest").data("disabled",!1).css("display","block"),!0===o.author.friends?D.addClass("unfriend").find("> span").text(ce("unfriend")):"requested_by_user"==o.author.friends?D.addClass("cancelRequest").find("> span").text(ce("cancel friend request")):"requested_by_author"==o.author.friends?(D.addClass("acceptRequest").find("> span").text(ce("accept friend request")),x.css("display","block")):D.find("> span").text(ce("add as friend"))))):g.css("display","none"),"object"==typeof o.likes?(T.css("display","block"),"string"==typeof o.likes.backend&&""!=o.likes.backend?(_.css("display","").data("disabled",!1),o.likes.liked?_.addClass("unlike").find("> span").text(ce("unlike")):_.removeClass("unlike").find("> span").text(ce("like"))):_.css("display","none"),"string"!=typeof o.likes.message||""==o.likes.message?A.css("display","none"):A.removeClass("negative").css("display","block").text(o.likes.message),"object"!=typeof o.likes.alsoLiked||0==o.likes.alsoLiked.length?M.css("display","none"):(M.css("display","block").empty(),t.each(o.likes.alsoLiked,function(e,a){var i=t("<li><div></div></li>").appendTo(M).find("> div");"string"==typeof a.url&&""!=a.url&&(i=i.html('<a href="'+a.url+'"></a>').find("> a")),i.attr("title",a.name),re.itemDetails.placeAvatar({src:a.avatar,$container:i})}))):T.css("display","none"),"object"==typeof o.tags?(t.each(o.tags,function(e,t){r+='<li data-id="'+e+'"><span>'+t+"</span></li>"}),""==r?H.css("display","none"):H.css("display","block").html(r)):H.css("display","none"),"string"!=typeof o.download||""==o.download?P.css("display","none"):(l=!0,P.attr("href",o.download).css("display","")),"object"==typeof o.email?(l=!0,E.attr("href","mailto:?to=&subject="+encodeURIComponent(o.email.subject)+"&body="+encodeURIComponent(o.email.body)).css("display","")):E.css("display","none"),R.css("display",l?"block":"none"),"object"==typeof o.meta){if(Q.css("display","block"),"object"==typeof o.meta.exif&&(p='<div class="exif"><h4><span>'+ce("Exif")+"</span></h4><table><tbody>",t.each(o.meta.exif,function(e,t){p+='<tr><td class="cell1">'+e+'</td><td class="cell2">'+t+"</td></tr>"}),ee.html(p+"</tbody></table></div>")),"object"==typeof o.meta.map)switch(ee.append('<div class="map">'+(o.meta.map.title==e?"":"<h4><span>"+o.meta.map.title+"</span></h4>")+"<div></div></div>"),pe.itemDetails.maps.google=null,o.meta.map.type){case"google":"object"==typeof google&&"object"==typeof google.maps&&(i=new google.maps.LatLng(o.meta.map.settings.lat,o.meta.map.settings.lng),pe.itemDetails.maps.google=new google.maps.Map(t("> div.map > div",ee)[0],{center:i,zoom:o.meta.map.settings.zoom,mapTypeId:google.maps.MapTypeId[o.meta.map.settings.type],scrollwheel:!1}),new google.maps.Marker({position:i,map:pe.itemDetails.maps.google}))}ee.css({display:"none"})}else Q.css("display","none");m.data("plugin_eds_tinyscrollbar").update()}},re.itemDetails.resize=function(){le.itemDetails.show&&(m.height(pe.baseWrapper.height-pe.itemDetails.wrapper.verticalOffset-pe.thumbnails.wrapper.effectiveHeight-pe.interfaceActions.wrapper.height),m.data("plugin_eds_tinyscrollbar").update("relative"))},re.itemDisplay={},re.itemDisplay.init=function(){te=t('<div class="itemDisplayWrapper '+(le.itemDetails.rightSide?"left":"right")+'"></div>'),o.append(te),pe.itemDisplay.wrapper.verticalOffset=te.outerHeight(!0)-te.height(),pe.itemDisplay.wrapper.horizontalOffset=te.outerWidth(!0)-te.width(),ae=t('<div class="itemDisplayContainer"></div>').appendTo(te),ie=t('<div class="loadIndicator"></div>').appendTo(te)},re.itemDisplay.resize=function(){var e,a,i,s,n,o,r,l,c,d=de[pe.activeItem];switch(pe.itemDisplay.wrapper.height=pe.baseWrapper.height-pe.itemDisplay.wrapper.verticalOffset-pe.thumbnails.wrapper.effectiveHeight-pe.interfaceActions.wrapper.height,pe.itemDisplay.wrapper.width=pe.baseWrapper.width-pe.itemDisplay.wrapper.horizontalOffset-pe.itemDetails.wrapper.effectiveWidth,te.height(pe.itemDisplay.wrapper.height).width(pe.itemDisplay.wrapper.width),n=t("> .item.active",ae),d.type){case"image":if(0==n.length)return;o={width:pe.preloadedImages[d.src].width,height:pe.preloadedImages[d.src].height};break;case"video":o={width:d.video.width,height:d.video.height};break;case"audio":o={width:450,height:n.height()}}l={width:ae.width(),height:ae.height()},"video"==d.type||"image"==d.type&&(o.width>l.width||o.height>l.height)||"audio"==d.type&&o.width>l.width?(c=l.width/l.height,r=o.width/o.height,e=l.width,a="audio"==d.type?o.height:l.height,r<c?e=Math.round(l.height/o.height*o.width):r>c&&"audio"!=d.type&&(a=Math.round(l.width/o.width*o.height))):(e=o.width,a=o.height),s=Math.floor((l.width-e)/2),i=Math.floor((l.height-a)/2),n.css({width:e,height:a,marginTop:i,marginLeft:s})},re.itemDisplay.showItem=function(){var a,i,s,o=pe.activeItem,r=de[o],l=function(){a=ae.find(">").fadeOut(200,function(){a.remove()}).removeClass("active"),t('<img class="item active" src="'+r.src+'" alt="" style="display: none;" />').appendTo(ae).fadeIn(200),re.itemDisplay.resize(),ie.stop(!0).fadeOut(500)},c="";switch(r.type){case"image":pe.preloadedImages[r.src]!==e&&"success"==pe.preloadedImages[r.src].state?l():(ie.css({display:"none",left:0}).stop(!0).fadeIn(500,function(){ae.find(">").remove()}),re.preloadImage(r.src,function(){o==pe.activeItem&&l()}));break;case"video":switch(a=ae.find(">").removeClass("active").fadeOut(200,function(){a.remove()}),r.video.provider){case"youtube":i='<iframe class="item active" style="display: none;" src="//www.youtube.com/embed/'+r.video.id+'?wmode=opaque" frameborder="0" allowfullscreen></iframe>';break;case"vimeo":i='<iframe class="item active" style="display: none;" src="//player.vimeo.com/video/'+r.video.id+'" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>';break;case"wistia":i='<iframe class="wistia_embed item active" name="wistia_embed" style="display: none;" src="//fast.wistia.net/embed/iframe/'+r.video.id+'" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>';break;case"flowplayer":i='<div class="item active" style="display: block; opacity: 0;"></div>'}s=t(i).appendTo(ae),"flowplayer"==r.video.provider?(n(r.video.src,".mp4")?c="video/mp4":n(r.video.src,".webm")?c="video/webm":n(r.video.src,".ogg")?c="video/ogg":n(r.video.src,".flv")&&(c="video/flash"),s.animate({opacity:1},200).flowplayer({swf:le.flowplayerSwf,tooltip:!1,embed:!1,key:le.flowplayer.key,logo:le.flowplayer.logo,clip:{sources:[{type:c,src:r.video.src}]}})):s.fadeIn(200),ie.stop(!0).fadeOut(500),re.itemDisplay.resize();break;case"audio":a=ae.find(">").removeClass("active").fadeOut(200,function(){a.remove()}),s=t('<div class="item active" style="display: block; opacity: 0;"><audio src="'+r.audio.src+'" /></div>').appendTo(ae).animate({opacity:1},200),audiojs.create(t("> audio",s)[0]),ie.stop(!0).fadeOut(500),re.itemDisplay.resize()}},arguments.length>0&&t.extend(!0,le,arguments[0]),this.each(function(){var e=t(this).data("socialMediaBox");e&&(e instanceof Array?t.each(e,function(){de.push(this)}):de.push(e))}),0==de.length?this:(a=t("body").addClass("socialMediaBoxActive"),o=t('<div id="socialMediaBox" class="'+le.baseClass+'" style="visibility: hidden;"></div>').appendTo(a),re.thubnails.init(),re.itemDetails.init(),re.itemDisplay.init(),re.interfaceActions.init(),de.length>1&&(se=t('<div class="navigation previous '+(le.itemDetails.rightSide?"left":"right")+'"></div>').appendTo(o),ne=t('<div class="navigation next '+(le.itemDetails.rightSide?"left":"right")+'"></div>').appendTo(o)),oe=t('<div class="close"><span></span></div>'),o.append(oe),re.resize(),re.showItem(le.openAt,!0),o.css({display:"none",visibility:""}).fadeIn(200).on("click","> div.navigation",function(){t(this).hasClass("previous")?re.showItem(pe.activeItem-1):re.showItem(pe.activeItem+1)}),oe.on("click",function(){re.close()}),t(document).on("keyup.socialMediaBox",function(e){var a=t(document.activeElement);if(0!=a.filter("textarea").parents(".commentsWrapper").length||a.filter("input").parents(".commentsWrapper").length)return!1;switch(e.keyCode){case 37:re.showItem(pe.activeItem-1);break;case 39:re.showItem(pe.activeItem+1);break;case 27:re.close()}return!1}),ae.on("touchstart",function(e){"function"==typeof e.stopPropagation&&(e.stopPropagation(),e.preventDefault()),e.originalEvent.touches&&e.originalEvent.touches.length?e=e.originalEvent.touches[0]:e.originalEvent.changedTouches&&e.originalEvent.changedTouches.length&&(e=e.originalEvent.changedTouches[0]),pe.itemDisplay.touch.newTouch=!0,pe.itemDisplay.touch.startX=e.pageX,pe.itemDisplay.touch.startY=e.pageY}).on("touchmove",function(e){var t;"function"==typeof e.stopPropagation&&(e.stopPropagation(),e.preventDefault()),pe.itemDisplay.touch.newTouch&&(e.originalEvent.touches&&e.originalEvent.touches.length?e=e.originalEvent.touches[0]:e.originalEvent.changedTouches&&e.originalEvent.changedTouches.length&&(e=e.originalEvent.changedTouches[0]),t=pe.itemDisplay.touch.startX-e.pageX,Math.abs(t)<50||(pe.itemDisplay.touch.newTouch=!1,t>0?re.showItem(pe.activeItem+1):re.showItem(pe.activeItem-1)))}).on("touchend touchcancel",function(e){"function"==typeof e.stopPropagation&&(e.stopPropagation(),e.preventDefault()),pe.itemDisplay.touch.newTouch=!1}),t(window).on("resize.socialMediaBox",function(){re.resize()}),this)},t.fn.socialMediaBox4Journal=function(e){var i;if(!a)return a=!0,i=function(){var a,i,n,o,r,l,c,d=t(this),p=d.parents(".journalrow")[0].id,m="",u=0,h=t('<div id="socialMediaBox4JournalOverlay"'+("object"==typeof e.smbConfig&&e.smbConfig.baseClass?' class="'+e.smbConfig.baseClass+'"':"")+"><div></div><p></p></div>"),v=t("> p",h),f=t("> div",h),g=t("body"),y="",b=function(){t(document).off(".socialMediaBox4Journal"),h.fadeTo(400,0,function(){h.remove()}),g.removeClass("socialMediaBoxActive"),v.css("display","none")};g.append(h).addClass("socialMediaBoxActive"),h.fadeTo(400,1).on("click","> p > .close",function(){return b(),!1}),t.each(d.parents("#journalItems").eq(0).find(">").has(".journalitem > .jphoto"),function(t,a){a.id==p&&(e.smbConfig.openAt=t),m+=a.id.substring(a.id.indexOf("-")+1)+","}),m=m.substring(0,m.length-1),o=d.parents(".DnnModule-Journal").eq(0),c=0,u=0==o.length?0:"string"!=typeof(l=o.attr("class"))||""==l?0:($.each(l.split(/\s+/),function(e,t){if("object"==typeof(r=t.match(/\d+$/))&&null!=r)return c=parseInt(r[0]),!1}),c),a=s(),n=t.ajax({data:{action:"journal_entries",journalIds:m,journalModuleId:u,journalType:a.type,journalTarget:a.target},dataType:"json",type:"POST",url:e.entriesUrl,timeout:15e3,cache:!1,error:function(){y=e.errors.generalError},success:function(t){"success"==t.status?0==(i=t.entries).length&&(y=e.errors.noJournalItems):y=t.message},complete:function(){if(""!=y)return f.fadeTo(200,0,function(){f.css("display","none")}),void v.html(y+'<span class="close">X</span>').css({display:"block",opacity:0}).fadeTo(200,1);b(),t("<div />").data("socialMediaBox",i).socialMediaBox(e.smbConfig)}}),t(document).on("keyup.socialMediaBox4Journal",function(e){if(27==e.keyCode)return n.abort(),b(),!1})},t(".DnnModule-Journal").on("click",".journalitem > .jphoto a",function(){return i.call(this),!1}).on("click",".journalitem > .jphoto > img",i).on("mouseenter",".journalitem > .jphoto > img",function(){t(this).css("cursor","pointer")}),this})}();