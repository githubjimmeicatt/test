(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{"1yen":function(t,e,i){"use strict";i.r(e),i.d(e,"ReplaceContentComponent",(function(){return $}));var n=i("D57K"),o=i("sEIs"),c=i("bwdy"),a=i("C05f"),s=i("HM3f"),r=i("YtkY"),l=i("xVbo"),u=i("jIqt"),p=i("0Woy"),d=i("uuTa"),b=i("EM62"),f=i("OZ4H"),h=i("PlBB"),v=i("W1gw"),m=i("2kYt"),g=i("29Wa"),x=i("Cd2c"),y=i("ulve"),C=i("nIj0"),O=i("qvOF"),S=i("PBFl"),M=i("Y2X+"),k=i("bFHC"),R=i("mFH5");function j(t,e){if(1&t&&(b.Sb(0,"mat-option",15),b.Lc(1),b.Rb()),2&t){var i=e.$implicit;b.kc("value",i),b.Ab(1),b.Mc(i)}}function T(t,e){if(1&t){var i=b.Tb();b.Qb(0),b.Sb(1,"div",1),b.Sb(2,"div",2),b.Lc(3),b.Rb(),b.Rb(),b.Nb(4,"router-outlet"),b.Sb(5,"p",3),b.Lc(6),b.Rb(),b.Sb(7,"div",4),b.Sb(8,"mat-form-field",5),b.Sb(9,"mat-label"),b.Lc(10,"Choose item"),b.Rb(),b.Sb(11,"input",6),b.ac("ngModelChange",(function(t){return b.xc(i),b.ec().setFilter(t)})),b.Rb(),b.Sb(12,"mat-autocomplete",7,8),b.ac("optionSelected",(function(t){return b.xc(i),b.ec().select(t)})),b.Sb(14,"cdk-virtual-scroll-viewport",9),b.Jc(15,j,2,2,"mat-option",10),b.Rb(),b.Rb(),b.Rb(),b.Sb(16,"button",11),b.ac("click",(function(){return b.xc(i),b.ec().copySelected()})),b.Sb(17,"mat-icon"),b.Lc(18,"file_copy"),b.Rb(),b.Rb(),b.Rb(),b.Sb(19,"div",12),b.Sb(20,"button",13),b.ac("click",(function(){return b.xc(i),b.ec().closeDialog()})),b.Lc(21,"Cancel"),b.Rb(),b.Sb(22,"button",14),b.ac("click",(function(){return b.xc(i),b.ec().save()})),b.Lc(23,"Save"),b.Rb(),b.Rb(),b.Pb()}if(2&t){var n=e.ngIf,o=b.vc(13);b.Ab(3),b.Mc(n.isAddMode?"Add Existing Item":"Replace Content Item"),b.Ab(3),b.Nc(" ",n.isAddMode?"Select a content-item to add to this list.":"By replacing a content-item you can make other content appear in the slot of the original content."," "),b.Ab(5),b.kc("matAutocomplete",o)("ngModel",n.filterText),b.Ab(3),b.Gc("height",n.filteredOptions.length<6?48*n.filteredOptions.length:240,"px"),b.Ab(1),b.kc("cdkVirtualForOf",n.filteredOptions),b.Ab(1),b.kc("disabled",!n.isMatch),b.Ab(6),b.kc("disabled",!n.isMatch)}}var $=function(){function t(t,e,i,n,o){this.dialogRef=t,this.contentGroupService=e,this.router=i,this.route=n,this.snackBar=o,this.hostClass="dialog-component"}return t.prototype.ngOnInit=function(){var t=this;this.guid=this.route.snapshot.paramMap.get("guid"),this.part=this.route.snapshot.paramMap.get("part"),this.index=parseInt(this.route.snapshot.paramMap.get("index"),10),this.add=!!this.route.snapshot.queryParamMap.get("add"),this.subscription=new c.a,this.filterText$=new a.a(""),this.options$=new a.a([]);var e=Object(s.a)([this.filterText$,this.options$]).pipe(Object(r.a)((function(t){var e=Object(n.f)(t,2),i=e[0];return e[1].filter((function(t){return t.label.includes(i)})).map((function(t){return t.label}))})));this.templateVars$=Object(s.a)([this.filterText$,e]).pipe(Object(r.a)((function(e){var i=Object(n.f)(e,2),o=i[0],c=i[1];return{filterText:o,filteredOptions:c,isAddMode:t.add,isMatch:c.includes(o)}}))),this.fetchConfig(!1,null),this.refreshOnChildClosed()},t.prototype.ngOnDestroy=function(){this.filterText$.complete(),this.options$.complete(),this.subscription.unsubscribe()},t.prototype.closeDialog=function(){this.dialogRef.close()},t.prototype.setFilter=function(t){this.filterText$.next(t)},t.prototype.select=function(t){this.filterText$.next(t.option.value)},t.prototype.copySelected=function(){var t=this.buildContentGroup(),e={items:[{ContentTypeName:this.contentTypeName,DuplicateEntity:t.id}]},i=Object(d.a)(e);this.router.navigate(["edit/"+i],{relativeTo:this.route})},t.prototype.save=function(){var t=this;this.snackBar.open("Saving...");var e=this.buildContentGroup();this.contentGroupService.saveItem(e).subscribe((function(){t.snackBar.open("Saved",null,{duration:2e3}),t.closeDialog()}))},t.prototype.fetchConfig=function(t,e){var i=this,o=this.buildContentGroup();this.contentGroupService.getItems(o).subscribe((function(c){var a,s=Object.entries(c.Items).map((function(t){var e=Object(n.f)(t,2),i=e[0],o=e[1];return{id:parseInt(i,10),label:o+" ("+i+")"}}));if(i.options$.next(s),!o.add&&!t||null!=e){var r=t?e:c.SelectedId,l=(null===(a=i.options$.value.find((function(t){return t.id===r})))||void 0===a?void 0:a.label)||"";i.filterText$.next(l)}i.contentTypeName=c.ContentTypeName}))},t.prototype.refreshOnChildClosed=function(){var t=this;this.subscription.add(this.router.events.pipe(Object(l.a)((function(t){return t instanceof o.b})),Object(u.a)(!!this.route.snapshot.firstChild),Object(r.a)((function(){return!!t.route.snapshot.firstChild})),Object(p.a)(),Object(l.a)((function(t){var e=Object(n.f)(t,2);return e[0]&&!e[1]}))).subscribe((function(){var e,i=null===(e=t.router.getCurrentNavigation().extras)||void 0===e?void 0:e.state,n=null==i?void 0:i[Object.keys(i)[0]];t.fetchConfig(!0,n)})))},t.prototype.buildContentGroup=function(){var t,e,i=this;return{id:null!==(e=null===(t=this.options$.value.find((function(t){return t.label===i.filterText$.value})))||void 0===t?void 0:t.id)&&void 0!==e?e:null,guid:this.guid,part:this.part,index:this.index,add:this.add}},t.\u0275fac=function(e){return new(e||t)(b.Mb(f.h),b.Mb(h.a),b.Mb(o.c),b.Mb(o.a),b.Mb(v.b))},t.\u0275cmp=b.Gb({type:t,selectors:[["app-replace-content"]],hostVars:1,hostBindings:function(t,e){2&t&&b.Vb("className",e.hostClass)},decls:2,vars:3,consts:[[4,"ngIf"],["mat-dialog-title",""],[1,"dialog-title-box"],[1,"dialog-description"],[1,"options-box"],["appearance","standard","color","accent",1,"options-box__field"],["matInput","",3,"matAutocomplete","ngModel","ngModelChange"],[3,"optionSelected"],["auto","matAutocomplete"],["itemSize","48","minBufferPx","500","maxBufferPx","1000"],[3,"value",4,"cdkVirtualFor","cdkVirtualForOf"],["mat-icon-button","","matTooltip","Copy",1,"options-box__copy",3,"disabled","click"],[1,"dialog-component-actions"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],[3,"value"]],template:function(t,e){1&t&&(b.Jc(0,T,24,9,"ng-container",0),b.fc(1,"async")),2&t&&b.kc("ngIf",b.gc(1,1,e.templateVars$))},directives:[m.t,f.i,o.h,g.c,g.g,x.b,y.c,C.d,C.s,C.v,y.a,O.e,O.a,O.d,S.b,M.a,k.a,R.m],pipes:[m.b],styles:[".options-box[_ngcontent-%COMP%]{display:flex;align-items:flex-end}.options-box__field[_ngcontent-%COMP%]{width:40%}.options-box__copy[_ngcontent-%COMP%]{margin-left:8px}"],changeDetection:0}),t}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/11.22.00/ng-edit/replace-content-component.e9815260cb8f424a3b10.js.map